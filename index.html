<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MERACHI - Confia no Processo</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* ===============================
           üé® VARI√ÅVEIS CSS 
           =============================== */

        :root {
            /* Cores principais */
            --primary: #663399;
            --primary-light: #7B4BB8;
            --primary-dark: #4A2570;
            --accent: #FFD700;
            --accent-light: #FFF3A0;
            
            /* Cores de fundo */
            --bg-primary: #FAFBFC;
            --bg-secondary: #F8FAFC;
            --card-bg: rgba(255, 255, 255, 0.98);
            --card-bg-hover: rgba(255, 255, 255, 1);
            
            /* Cores de texto */
            --text-primary: #1E293B;
            --text-secondary: #475569;
            --text-muted: #64748B;
            --text-light: #94A3B8;
            
            /* Cores de status */
            --success: #10B981;
            --error: #EF4444;
            --warning: #F59E0B;
            --info: #3B82F6;
            
            /* Bordas e sombras */
            --border: #E2E8F0;
            --border-light: #F1F5F9;
            --radius: 12px;
            --radius-sm: 8px;
            --radius-lg: 16px;
            
            /* Sombras */
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.1);
            --shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.12);
            --shadow-xl: 0 16px 48px rgba(0, 0, 0, 0.15);
            
            /* Gradientes */
            --gradient-primary: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            --gradient-accent: linear-gradient(135deg, var(--accent) 0%, #FFE55C 100%);
            --gradient-bg: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        /* ===============================
           üîÑ RESET E BASE 
           =============================== */

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            font-size: 16px;
            overflow-x: hidden;
        }

        /* ===============================
           üì± CONTAINER PRINCIPAL 
           =============================== */

        .app-container {
            display: flex;
            min-height: 100vh;
            position: relative;
        }

        /* Indicador de navega√ß√£o ativa */
        .view-indicator {
            position: fixed;
            top: 20px;
            left: 300px;
            background: var(--gradient-primary);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            z-index: 100;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            opacity: 0;
            transform: translateY(-10px);
        }

        .view-indicator.show {
            opacity: 1;
            transform: translateY(0);
        }

        @media (max-width: 1024px) {
            .view-indicator {
                left: 20px;
            }
        }

        /* ===============================
           üß≠ SIDEBAR 
           =============================== */

        .sidebar {
            width: 280px;
            background: var(--card-bg);
            border-right: 1px solid var(--border);
            position: fixed;
            left: 0;
            top: 0;
            height: 100vh;
            z-index: 1000;
            transition: all 0.3s ease;
            backdrop-filter: blur(20px);
            box-shadow: var(--shadow);
        }

        .sidebar-header {
            padding: 32px 24px;
            border-bottom: 1px solid var(--border-light);
            display: flex;
            align-items: center;
            gap: 16px;
            position: relative;
        }

        .logo {
            width: 48px;
            height: 48px;
            background: var(--gradient-primary);
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 800;
            font-size: 1.2rem;
            box-shadow: var(--shadow-sm);
        }

        .brand h1 {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .brand p {
            font-size: 0.85rem;
            color: var(--text-muted);
            font-weight: 500;
        }

        .sidebar-toggle {
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            font-size: 1.2rem;
            color: var(--text-muted);
            cursor: pointer;
            padding: 8px;
            border-radius: var(--radius-sm);
            transition: all 0.2s ease;
            display: none;
        }

        .sidebar-toggle:hover {
            background: var(--bg-secondary);
            color: var(--text-primary);
        }

        .sidebar-nav {
            padding: 24px 0;
            overflow-y: auto;
            height: calc(100vh - 140px);
        }

        .nav-section {
            margin-bottom: 32px;
        }

        .nav-section-title {
            font-size: 0.75rem;
            font-weight: 700;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 0 24px 12px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 24px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s ease;
            border-left: 3px solid transparent;
            font-weight: 500;
        }

        .nav-item:hover {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border-left-color: var(--primary-light);
        }

        .nav-item.active {
            background: rgba(102, 51, 153, 0.1);
            color: var(--primary);
            border-left-color: var(--primary);
            font-weight: 600;
        }

        .nav-item .icon {
            font-size: 1.1rem;
            width: 20px;
            text-align: center;
        }

        .nav-item .label {
            font-size: 0.9rem;
        }

        /* ===============================
           üì± CONTE√öDO PRINCIPAL 
           =============================== */

        .main-content {
            flex: 1;
            margin-left: 280px;
            min-height: 100vh;
            background: var(--bg-primary);
            transition: all 0.3s ease;
            max-width: calc(100vw - 280px);
            padding: 0 32px 32px;
        }

        /* ===============================
           üìä HEADER DA P√ÅGINA 
           =============================== */

        .page-header {
            background: var(--gradient-bg);
            margin: 0 -32px 32px;
            padding: 48px 32px;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .page-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="white" opacity="0.1"/><circle cx="75" cy="75" r="1" fill="white" opacity="0.1"/><circle cx="50" cy="10" r="0.5" fill="white" opacity="0.1"/><circle cx="10" cy="60" r="0.5" fill="white" opacity="0.1"/><circle cx="90" cy="40" r="0.5" fill="white" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            pointer-events: none;
        }

        .page-header-content {
            position: relative;
            z-index: 1;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }

        .page-title {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 8px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .page-subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            font-weight: 500;
            margin-bottom: 24px;
        }

        .status-badges {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .status-badge-item {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .header-actions {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .sync-all-btn, .theme-toggle-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 12px 20px;
            border-radius: var(--radius);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            backdrop-filter: blur(10px);
            font-size: 0.9rem;
        }

        .sync-all-btn:hover, .theme-toggle-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-1px);
        }

        .theme-toggle-btn {
            width: 48px;
            padding: 12px;
            text-align: center;
        }

        /* ===============================
           üìà M√âTRICAS 
           =============================== */

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
            margin-bottom: 32px;
        }

        .metric-card {
            background: var(--card-bg);
            padding: 32px 24px;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
            border: 1px solid var(--border-light);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .metric-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }

        .metric-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-primary);
        }

        .metric-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .metric-icon {
            font-size: 1.5rem;
            opacity: 0.8;
        }

        .metric-trend {
            font-size: 0.8rem;
            font-weight: 600;
            padding: 4px 8px;
            border-radius: 12px;
            background: var(--bg-secondary);
            color: var(--success);
        }

        .metric-number {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 8px;
            line-height: 1;
        }

        .metric-label {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .metric-description {
            font-size: 0.85rem;
            color: var(--text-muted);
            line-height: 1.4;
        }

        /* ===============================
           üéõÔ∏è FILTROS 
           =============================== */

        .filters-section {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: 24px;
            margin-bottom: 32px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-light);
        }

        .filters-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .filters-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .filter-btn {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            color: var(--text-secondary);
            padding: 8px 16px;
            border-radius: var(--radius-sm);
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .filter-btn:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .period-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
            padding: 4px;
            background: var(--bg-secondary);
            border-radius: var(--radius);
        }

        .period-tab {
            flex: 1;
            padding: 12px 16px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            font-weight: 600;
            font-size: 0.9rem;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .period-tab:hover {
            background: rgba(102, 51, 153, 0.1);
            color: var(--primary);
        }

        .period-tab.active {
            background: var(--primary);
            color: white;
            box-shadow: var(--shadow-sm);
        }

        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
        }

        .filter-label {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .filter-input, .filter-select {
            padding: 12px 16px;
            border: 2px solid var(--border);
            border-radius: var(--radius-sm);
            font-size: 0.9rem;
            background: white;
            color: var(--text-primary);
            transition: all 0.2s ease;
        }

        .filter-input:focus, .filter-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(102, 51, 153, 0.1);
        }

        /* ===============================
           üìã CONTE√öDO 
           =============================== */

        .content-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 32px;
        }

        .content-section {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
            border: 1px solid var(--border-light);
            overflow: hidden;
        }

        .section-header {
            padding: 24px 24px 0;
            border-bottom: 1px solid var(--border-light);
            margin-bottom: 0;
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .section-subtitle {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-bottom: 20px;
        }

        .section-actions {
            display: flex;
            gap: 12px;
            margin-bottom: 24px;
        }

        .section-btn {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            color: var(--text-secondary);
            padding: 8px 16px;
            border-radius: var(--radius-sm);
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .section-btn:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .section-content {
            padding: 24px;
            max-height: 600px;
            overflow-y: auto;
        }

        /* ===============================
           üìù ITEMS DE CONTE√öDO 
           =============================== */

        .event-item, .task-item {
            background: var(--bg-secondary);
            border: 1px solid var(--border-light);
            border-radius: var(--radius);
            padding: 20px;
            margin-bottom: 16px;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .event-item:hover, .task-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
            border-color: var(--primary-light);
        }

        .item-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
            line-height: 1.4;
        }

        .item-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            align-items: center;
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .item-meta span {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-urgent { background: #FEE2E2; color: #DC2626; }
        .status-high { background: #FEF3C7; color: #D97706; }
        .status-normal { background: #DBEAFE; color: #2563EB; }
        .status-low { background: #F3F4F6; color: #6B7280; }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-muted);
        }

        .empty-state::before {
            content: 'ü¶ã';
            font-size: 4rem;
            display: block;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        /* ===============================
           üöÄ FLOATING ACTION BUTTON 
           =============================== */

        .fab {
            position: fixed;
            bottom: 32px;
            right: 32px;
            width: 64px;
            height: 64px;
            background: var(--gradient-primary);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 24px;
            cursor: pointer;
            box-shadow: var(--shadow-lg);
            transition: all 0.3s ease;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .fab:hover {
            transform: scale(1.1) translateY(-2px);
            box-shadow: var(--shadow-xl);
        }

        .fab:active {
            transform: scale(0.95);
        }

        /* ===============================
           üìÑ MODAL 
           =============================== */

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(8px);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-xl);
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            border: 1px solid var(--border-light);
        }

        .modal-header {
            padding: 32px 32px 24px;
            border-bottom: 1px solid var(--border-light);
            position: relative;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .modal-subtitle {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-bottom: 24px;
        }

        .modal-close {
            position: absolute;
            top: 24px;
            right: 24px;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--text-muted);
            cursor: pointer;
            padding: 8px;
            border-radius: var(--radius-sm);
            transition: all 0.2s ease;
        }

        .modal-close:hover {
            background: var(--bg-secondary);
            color: var(--text-primary);
        }

        .modal-tabs {
            display: flex;
            gap: 4px;
            background: var(--bg-secondary);
            padding: 4px;
            border-radius: var(--radius);
        }

        .tab-btn {
            flex: 1;
            padding: 12px 16px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            font-weight: 600;
            font-size: 0.85rem;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .tab-btn:hover {
            background: rgba(255, 255, 255, 0.5);
            color: var(--primary);
        }

        .tab-btn.active {
            background: white;
            color: var(--primary);
            box-shadow: var(--shadow-sm);
        }

        .tab-content {
            display: none;
            padding: 0 32px 32px;
        }

        .tab-content.active {
            display: block;
        }

        /* ===============================
           üìù FORMUL√ÅRIOS 
           =============================== */

        .form-group {
            margin-bottom: 24px;
        }

        .form-label {
            display: block;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid var(--border);
            border-radius: var(--radius);
            font-size: 1rem;
            font-family: inherit;
            background: white;
            color: var(--text-primary);
            transition: all 0.2s ease;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(102, 51, 153, 0.1);
        }

        .form-textarea {
            resize: vertical;
            min-height: 120px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .form-actions {
            display: flex;
            gap: 16px;
            margin-top: 40px;
            padding-top: 32px;
            border-top: 1px solid var(--border-light);
        }

        .btn {
            flex: 1;
            padding: 16px 24px;
            border: none;
            border-radius: var(--radius);
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: var(--gradient-primary);
            color: white;
            box-shadow: var(--shadow-sm);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .btn-secondary {
            background: var(--bg-secondary);
            color: var(--text-secondary);
            border: 2px solid var(--border);
        }

        .btn-secondary:hover {
            background: white;
            border-color: var(--primary);
            color: var(--primary);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        .btn-loading {
            position: relative;
            color: transparent !important;
        }

        .btn-loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
            border: 2px solid currentColor;
            border-top: 2px solid transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        /* ===============================
           üîî NOTIFICA√á√ïES 
           =============================== */

        .notification {
            position: fixed;
            top: 24px;
            right: 24px;
            max-width: 400px;
            padding: 16px 20px;
            border-radius: var(--radius);
            color: white;
            font-weight: 600;
            font-size: 0.9rem;
            z-index: 3000;
            box-shadow: var(--shadow-lg);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            animation: slideInRight 0.3s ease;
            cursor: pointer;
        }

        .notification.success { 
            background: linear-gradient(135deg, var(--success), #059669);
        }
        .notification.error { 
            background: linear-gradient(135deg, var(--error), #DC2626);
        }
        .notification.info { 
            background: var(--gradient-primary);
        }
        .notification.warning { 
            background: linear-gradient(135deg, var(--warning), #D97706);
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* ===============================
           üì± RESPONSIVIDADE 
           =============================== */

        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-100%);
            }
            
            .sidebar.open {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
                max-width: 100%;
            }
            
            .content-grid {
                grid-template-columns: 1fr;
            }
            
            .metrics-grid {
                grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .main-content {
                padding: 16px;
            }
            
            .page-header {
                padding: 24px;
            }
            
            .page-header-content {
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
            }
            
            .page-title {
                font-size: 1.6rem;
            }
            
            .filters-grid {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .form-actions {
                flex-direction: column;
            }
            
            .modal-content {
                margin: 20px;
                max-height: calc(100vh - 40px);
            }
            
            .modal-header {
                padding: 24px 24px 0;
            }
            
            .tab-content {
                padding: 0 24px 24px;
            }
            
            .fab {
                bottom: 24px;
                right: 24px;
                width: 56px;
                height: 56px;
                font-size: 20px;
            }
        }

        /* ===============================
           üåô TEMA ESCURO 
           =============================== */

        [data-theme="dark"] {
            --bg-primary: #0F172A;
            --bg-secondary: #1E293B;
            --card-bg: rgba(30, 41, 59, 0.95);
            --card-bg-hover: rgba(30, 41, 59, 1);
            
            --text-primary: #F1F5F9;
            --text-secondary: #CBD5E1;
            --text-muted: #94A3B8;
            --text-light: #64748B;
            
            --border: #334155;
            --border-light: #475569;
            
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.3);
            --shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
            --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.3);
            --shadow-xl: 0 16px 48px rgba(0, 0, 0, 0.4);
        }

        /* Corre√ß√µes espec√≠ficas para tema escuro */
        [data-theme="dark"] .metric-number {
            color: #10B981; /* Verde claro para melhor contraste */
        }

        [data-theme="dark"] .form-input,
        [data-theme="dark"] .form-select,
        [data-theme="dark"] .form-textarea,
        [data-theme="dark"] .filter-input,
        [data-theme="dark"] .filter-select {
            background: #1E293B;
            color: #F1F5F9;
            border-color: #475569;
        }

        [data-theme="dark"] .form-input::placeholder,
        [data-theme="dark"] .filter-input::placeholder {
            color: #64748B;
        }

        [data-theme="dark"] .form-input:focus,
        [data-theme="dark"] .form-select:focus,
        [data-theme="dark"] .form-textarea:focus,
        [data-theme="dark"] .filter-input:focus,
        [data-theme="dark"] .filter-select:focus {
            background: #334155;
            border-color: #10B981;
            box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.1);
        }

        [data-theme="dark"] .metric-label {
            color: #CBD5E1;
        }

        [data-theme="dark"] .metric-description {
            color: #94A3B8;
        }

        [data-theme="dark"] .calendar-day-number {
            color: #F1F5F9;
        }

        [data-theme="dark"] .calendar-day-cell {
            background: #1E293B;
            border-color: #475569;
        }

        [data-theme="dark"] .calendar-day-cell:hover {
            background: #334155;
            border-color: #10B981;
        }

        [data-theme="dark"] .calendar-day-cell.today {
            background: rgba(16, 185, 129, 0.2);
            border-color: #10B981;
            box-shadow: inset 0 0 20px rgba(16, 185, 129, 0.3);
        }

        /* ===============================
           üöÄ LOADING STATES 
           =============================== */

        .loading {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            z-index: 3000;
            align-items: center;
            justify-content: center;
        }

        .loading.active {
            display: flex;
        }

        .loading-content {
            text-align: center;
            color: white;
        }

        .spinner {
            width: 48px;
            height: 48px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid var(--accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        .loading-text {
            font-size: 1.1rem;
            font-weight: 600;
        }

        /* ===============================
           üìà EMPTY STATES 
           =============================== */

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-muted);
        }

        .empty-state::before {
            content: 'ü¶ã';
            font-size: 4rem;
            display: block;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .empty-state h3 {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .empty-state p {
            font-size: 0.9rem;
            line-height: 1.5;
        }

        /* ===============================
           üìÖ ESTILOS DO CALEND√ÅRIO
           =============================== */

        .calendar-container {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: 24px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-light);
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 2px solid var(--border-light);
        }

        .calendar-month-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
            margin: 0;
        }

        .calendar-nav-btn {
            background: var(--gradient-primary);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .calendar-nav-btn:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-sm);
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background: var(--border-light);
            border-radius: var(--radius);
            overflow: hidden;
        }

        .calendar-day-header {
            background: var(--gradient-primary);
            color: white;
            padding: 12px 8px;
            text-align: center;
            font-weight: 700;
            font-size: 0.85rem;
        }

        .calendar-day-cell {
            background: white;
            min-height: 100px;
            padding: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            border: 2px solid transparent;
        }

        .calendar-day-cell:hover {
            background: var(--bg-secondary);
            border-color: var(--primary-light);
        }

        .calendar-day-cell.today {
            background: var(--accent-light);
            border-color: var(--accent);
            box-shadow: inset 0 0 20px rgba(255, 215, 0, 0.3);
        }

        .calendar-day-cell.other-month {
            opacity: 0.3;
            background: var(--bg-secondary);
        }

        .calendar-day-number {
            font-weight: 700;
            font-size: 1rem;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .calendar-day-content {
            display: flex;
            flex-direction: column;
            gap: 2px;
            max-height: 70px;
            overflow: hidden;
        }

        .calendar-event-item, .calendar-task-item, .calendar-project-task-item {
            font-size: 0.7rem;
            padding: 2px 4px;
            border-radius: 3px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            font-weight: 500;
            line-height: 1.2;
        }

        .calendar-event-item {
            background: var(--gradient-primary);
            color: white;
        }

        .calendar-task-item {
            background: var(--accent);
            color: var(--text-primary);
        }

        .calendar-project-task-item {
            background: linear-gradient(135deg, #FF6B6B, #4ECDC4);
            color: white;
            font-weight: 600;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        /* Modal de detalhes do dia */
        .day-details-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(8px);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .day-details-modal.active {
            display: flex;
        }

        .day-details-content {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-xl);
            max-width: 500px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            border: 1px solid var(--border-light);
        }

        .day-details-header {
            padding: 24px;
            border-bottom: 1px solid var(--border-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .day-details-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--text-primary);
            margin: 0;
        }

        .day-details-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--text-muted);
            cursor: pointer;
            padding: 8px;
            border-radius: var(--radius-sm);
            transition: all 0.2s ease;
        }

        .day-details-close:hover {
            background: var(--bg-secondary);
            color: var(--text-primary);
        }

        .day-details-body {
            padding: 24px;
        }

        .day-section {
            margin-bottom: 24px;
        }

        .day-section:last-child {
            margin-bottom: 0;
        }

        .day-section-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .day-item {
            background: var(--bg-secondary);
            padding: 12px;
            border-radius: var(--radius-sm);
            margin-bottom: 8px;
            border-left: 4px solid var(--primary);
        }

        .day-item:last-child {
            margin-bottom: 0;
        }

        .day-item-title {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        /* Estilo para se√ß√µes de setor */
        .sector-section {
            margin-bottom: 32px;
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-light);
        }

        .sector-title {
            background: linear-gradient(135deg, var(--bg-secondary), var(--card-bg));
            padding: 16px 20px;
            border-bottom: 2px solid var(--border-light);
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1rem;
            font-weight: 700;
            color: var(--text-primary);
            position: relative;
        }

        .sector-count {
            background: var(--primary);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 800;
            margin-left: auto;
            box-shadow: var(--shadow-sm);
        }

        .sector-name {
            text-transform: uppercase;
            font-weight: 800;
            font-size: 1.05rem;
            color: var(--primary);
        }

        [data-theme="dark"] .sector-title {
            background: linear-gradient(135deg, #334155, #1E293B);
            border-color: #475569;
        }

        [data-theme="dark"] .sector-count {
            background: #10B981;
            color: #0F172A;
        }

        /* Corre√ß√£o espec√≠fica para nomes de setores no tema escuro */
        [data-theme="dark"] .sector-name {
            color: #F1F5F9 !important;
        }

        /* Estilo para o bot√£o de reset */
        .reset-btn {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            color: var(--text-muted);
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.7rem;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-left: 4px;
        }

        .reset-btn:hover {
            background: #FEE2E2;
            color: #DC2626;
            border-color: #FECACA;
            transform: scale(1.1);
        }

        /* Responsive para calend√°rio */
        @media (max-width: 768px) {
            .calendar-day-cell {
                min-height: 80px;
                padding: 4px;
            }

            .calendar-day-number {
                font-size: 0.9rem;
            }

            .calendar-event-item, .calendar-task-item {
                font-size: 0.65rem;
                padding: 1px 3px;
            }

            .calendar-month-title {
                font-size: 1.2rem;
            }

            .calendar-nav-btn {
                width: 35px;
                height: 35px;
                font-size: 1rem;
            }
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideIn {
            from { transform: translateX(-100%); }
            to { transform: translateX(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease;
        }

        .slide-in {
            animation: slideIn 0.3s ease;
        }
    </style>
</head>
<body data-theme="light">
    <div class="app-container">
        <!-- Indicador de Visualiza√ß√£o Ativa -->
        <div class="view-indicator" id="viewIndicator">üìä Dashboard Principal</div>
        
        <!-- ===============================
             üß≠ SIDEBAR 
             =============================== -->
        <nav class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">M</div>
                <div class="brand">
                    <h1>MERACHI</h1>
                    <p>Confia no Processo</p>
                </div>
                <button class="sidebar-toggle" onclick="toggleSidebar()">
                    ‚ò∞
                </button>
            </div>

            <div class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Principal</div>
                    <div class="nav-item active" onclick="showView('dashboard')">
                        <div class="icon">üìä</div>
                        <div class="label">Dashboard</div>
                    </div>
                    <div class="nav-item" onclick="showView('agenda')">
                        <div class="icon">üìÖ</div>
                        <div class="label">Agenda</div>
                    </div>
                    <div class="nav-item" onclick="showView('demandas')">
                        <div class="icon">‚úÖ</div>
                        <div class="label">Demandas</div>
                    </div>
                    <div class="nav-item" onclick="showView('calendario')">
                        <div class="icon">üóìÔ∏è</div>
                        <div class="label">Calend√°rio</div>
                    </div>
                </div>

                <div class="nav-section">
                    <div class="nav-section-title">Ferramentas</div>
                    <div class="nav-item" onclick="showView('analytics')">
                        <div class="icon">üìà</div>
                        <div class="label">Analytics</div>
                    </div>
                    <div class="nav-item" onclick="showView('automacao')">
                        <div class="icon">ü§ñ</div>
                        <div class="label">Automa√ß√£o</div>
                    </div>
                    <div class="nav-item" onclick="showView('integracao')">
                        <div class="icon">üîó</div>
                        <div class="label">Integra√ß√µes</div>
                    </div>
                </div>

                <div class="nav-section">
                    <div class="nav-section-title">Configura√ß√µes</div>
                    <div class="nav-item" onclick="showView('equipe')">
                        <div class="icon">üë•</div>
                        <div class="label">Equipe</div>
                    </div>
                    <div class="nav-item" onclick="showView('configuracoes')">
                        <div class="icon">‚öôÔ∏è</div>
                        <div class="label">Configura√ß√µes</div>
                    </div>
                </div>
            </div>
        </nav>

        <!-- ===============================
             üì± CONTE√öDO PRINCIPAL 
             =============================== -->
        <main class="main-content" id="mainContent">
            <!-- ===============================
                 üìä HEADER DA P√ÅGINA 
                 =============================== -->
            <div class="page-header">
                <div class="page-header-content">
                    <div>
                        <h1 class="page-title">MERACHI</h1>
                        <p class="page-subtitle">Vis√£o geral do universo Confia no Processo</p>
                        <div class="status-badges">
                            <div class="status-badge-item">
                                üìÖ Google Calendar
                            </div>
                            <div class="status-badge-item">
                                ‚úÖ ClickUp
                            </div>
                            <div class="status-badge-item">
                                üîÑ n8n Automations
                            </div>
                        </div>
                    </div>
                    <div class="header-actions">
                        <button class="sync-all-btn" onclick="syncAll()">
                            üîÑ Sincronizar Tudo
                        </button>
                        <button class="theme-toggle-btn" onclick="toggleTheme()" id="themeToggle">
                            üåô
                        </button>
                    </div>
                </div>
            </div>

            <!-- ===============================
                 üìà M√âTRICAS 
                 =============================== -->
            <div class="metrics-grid">
                <div class="metric-card">
                    <div class="metric-header">
                        <div class="metric-icon">üìä</div>
                        <div class="metric-trend">‚Üó +12%</div>
                    </div>
                    <div class="metric-number" id="totalEvents">0</div>
                    <div class="metric-label">Total de Eventos</div>
                    <div class="metric-description">Agenda e demandas combinadas</div>
                </div>

                <div class="metric-card">
                    <div class="metric-header">
                        <div class="metric-icon">‚úÖ</div>
                        <div class="metric-trend">‚Üó +8%</div>
                    </div>
                    <div class="metric-number" id="completed">0</div>
                    <div class="metric-label">Conclu√≠dos</div>
                    <div class="metric-description">Esta semana</div>
                </div>

                <div class="metric-card">
                    <div class="metric-header">
                        <div class="metric-icon">üìã</div>
                        <div class="metric-trend">‚Üí Est√°vel</div>
                    </div>
                    <div class="metric-number" id="inProgress">0</div>
                    <div class="metric-label">Em Progresso</div>
                    <div class="metric-description">Sendo executadas</div>
                </div>
            </div>

            <!-- ===============================
                 üéõÔ∏è FILTROS AVAN√áADOS 
                 =============================== -->
            <div class="filters-section">
                <div class="filters-header">
                    <div class="filters-title">
                        üîç Filtros Inteligentes
                    </div>
                    <button class="filter-btn" onclick="clearAllFilters()">
                        Limpar Filtros
                    </button>
                </div>

                <div class="period-tabs">
                    <button class="period-tab active" onclick="setPeriod('dia')">Hoje</button>
                    <button class="period-tab" onclick="setPeriod('semana')">Semana</button>
                    <button class="period-tab" onclick="setPeriod('mes')">M√™s</button>
                    <button class="period-tab" onclick="setPeriod('todas')" style="background: linear-gradient(135deg, #FF6B6B, #4ECDC4); color: white; font-weight: 700;">üåü Todas</button>
                    <button class="period-tab" onclick="setPeriod('custom')">Personalizado</button>
                </div>

                <div class="filters-grid">
                    <div class="filter-group">
                        <label class="filter-label">üîç Buscar por t√≠tulo</label>
                        <input type="text" class="filter-input" id="filterText" placeholder="Digite para buscar..." onkeyup="applyFilters()">
                    </div>

                    <div class="filter-group">
                        <label class="filter-label">üè¢ Setor</label>
                        <select class="filter-select" id="filterSetor" onchange="applyFilters()">
                            <option value="">Todos os setores</option>
                            <option value="Design">üé® Design</option>
                            <option value="Audiovisual">üé¨ Audiovisual</option>
                            <option value="Social Media">üì± Social Media</option>
                            <option value="Gest√£o">üìä Gest√£o</option>
                            <option value="Est√∫dio">üéµ Est√∫dio</option>
                            <option value="Artista">üé§ Artista</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label class="filter-label">üìä Status</label>
                        <select class="filter-select" id="filterStatus" onchange="applyFilters()">
                            <option value="">Todos os status</option>
                            <option value="open">üìã Abertas</option>
                            <option value="progress">‚ö° Em Progresso</option>
                            <option value="review">üëÄ Em Revis√£o</option>
                            <option value="complete">‚úÖ Completas</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label class="filter-label">üë§ Respons√°vel</label>
                        <input type="text" class="filter-input" id="filterAssignee" placeholder="Nome do respons√°vel" onkeyup="applyFilters()">
                    </div>

                    <div class="filter-group">
                        <label class="filter-label">üìÖ Data espec√≠fica</label>
                        <input type="date" class="filter-input" id="filterDate" onchange="applyFilters()">
                    </div>

                    <div class="filter-group">
                        <label class="filter-label">‚ö° Prioridade</label>
                        <select class="filter-select" id="filterPriority" onchange="applyFilters()">
                            <option value="">Todas as prioridades</option>
                            <option value="urgent">üö® Urgente</option>
                            <option value="high">üî• Alta</option>
                            <option value="normal">üìå Normal</option>
                            <option value="low">üìã Baixa</option>
                        </select>
                    </div>
                </div>

                <!-- NOVO: Controles de Visualiza√ß√£o de Projeto -->
                <div class="project-view-controls" id="projectViewControls" style="display: none; margin-top: 20px; padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; color: white;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                        <h3 style="margin: 0; font-size: 1.1rem;">üåü Modo Visualiza√ß√£o Completa de Projeto</h3>
                        <button class="filter-btn" onclick="toggleProjectView()" style="background: rgba(255,255,255,0.2); color: white; border: 1px solid rgba(255,255,255,0.3);">
                            üìä Carregar Timeline Completo
                        </button>
                    </div>
                    <p style="margin: 0; opacity: 0.9; font-size: 0.85rem;">
                        Visualize todas as tarefas do projeto distribu√≠das no calend√°rio, independente da data atual. Ideal para ter uma vis√£o geral do progresso e cronograma.
                    </p>
                </div>
            </div>

            <!-- ===============================
                 üìã CONTE√öDO PRINCIPAL 
                 =============================== -->
            <div class="content-grid">
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">
                            üìÖ Eventos da Agenda
                        </h2>
                        <p class="section-subtitle">Pr√≥ximos compromissos do Google Calendar</p>
                        <div class="section-actions">
                            <button class="section-btn" onclick="syncCalendar()">
                                üîÑ Sincronizar
                            </button>
                            <button class="section-btn" onclick="addNewEvent()">
                                ‚ûï Novo Evento
                            </button>
                        </div>
                    </div>
                    <div class="section-content" id="calendarEvents">
                        <div class="empty-state">Carregando eventos...</div>
                    </div>
                </div>

                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">
                            ‚úÖ Demandas Ativas
                        </h2>
                        <p class="section-subtitle">Tarefas organizadas por setor</p>
                        <div class="section-actions">
                            <button class="section-btn" onclick="syncClickUp()">
                                üîÑ Sincronizar
                            </button>
                            <button class="section-btn" onclick="addNewTask()">
                                ‚ûï Nova Demanda
                            </button>
                        </div>
                    </div>
                    <div class="section-content" id="clickupTasks">
                        <div class="empty-state">Carregando demandas...</div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- ===============================
         üöÄ FLOATING ACTION BUTTON 
         =============================== -->
    <button class="fab" onclick="toggleQuickModal()" id="fabBtn">
        ‚ûï
    </button>

    <!-- ===============================
         üìÑ MODAL QUICK ACTIONS 
         =============================== -->
    <div class="modal" id="quickModal" onclick="closeModalOnBackdrop(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2 class="modal-title">
                    ‚ö° Quick Actions
                </h2>
                <p class="modal-subtitle">Crie rapidamente eventos e demandas</p>
                <button class="modal-close" onclick="closeQuickModal()">‚úï</button>
                
                <div class="modal-tabs">
                    <button class="tab-btn active" id="tab-task-btn" onclick="switchTab('task')">
                        ‚úÖ Nova Demanda
                    </button>
                    <button class="tab-btn" id="tab-event-btn" onclick="switchTab('event')">
                        üìÖ Novo Evento
                    </button>
                    <button class="tab-btn" id="tab-bulk-btn" onclick="switchTab('bulk')">
                        ü§ñ IA Bulk
                    </button>
                </div>
            </div>

            <!-- Tab Nova Demanda -->
            <div class="tab-content active" id="tab-task">
                <form id="taskForm" onsubmit="createQuickTask(event)">
                    <div class="form-group">
                        <label class="form-label">üìù T√≠tulo da Demanda</label>
                        <input type="text" class="form-input" id="taskTitle" placeholder="Ex: Finalizar apresenta√ß√£o do projeto X" required>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">üè¢ Setor</label>
                            <select class="form-select" id="taskSetor" required>
                                <option value="">Selecionar setor</option>
                                <option value="Design">üé® Design</option>
                                <option value="Audiovisual">üé¨ Audiovisual</option>
                                <option value="Social Media">üì± Social Media</option>
                                <option value="Gest√£o de Projetos">üìä Gest√£o</option>
                                <option value="Est√∫dio">üéµ Est√∫dio</option>
                                <option value="M√∫sico">üé§ Artista</option>
                                <option value="Geral">üìã Geral</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">‚ö° Prioridade</label>
                            <select class="form-select" id="taskPriority">
                                <option value="normal">üìå Normal</option>
                                <option value="high">üî• Alta</option>
                                <option value="urgent">üö® Urgente</option>
                                <option value="low">üìã Baixa</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">üìÖ Data de Vencimento</label>
                            <input type="date" class="form-input" id="taskDueDate">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">üë§ Respons√°vel</label>
                            <input type="text" class="form-input" id="taskAssignee" placeholder="Nome do respons√°vel">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">üìÑ Descri√ß√£o</label>
                        <textarea class="form-textarea" id="taskDescription" placeholder="Detalhes da demanda, contexto e observa√ß√µes..."></textarea>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeQuickModal()">
                            Cancelar
                        </button>
                        <button type="submit" class="btn btn-primary">
                            ‚úÖ Criar Demanda
                        </button>
                    </div>
                </form>
            </div>

            <!-- Tab Novo Evento -->
            <div class="tab-content" id="tab-event">
                <form id="eventForm" onsubmit="createQuickEvent(event)">
                    <div class="form-group">
                        <label class="form-label">üìù T√≠tulo do Evento</label>
                        <input type="text" class="form-input" id="eventTitle" placeholder="Ex: Reuni√£o de planejamento" required>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">üìÖ Data</label>
                            <input type="date" class="form-input" id="eventDate" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">üïê Hor√°rio</label>
                            <input type="time" class="form-input" id="eventTime" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">‚è±Ô∏è Dura√ß√£o (minutos)</label>
                            <select class="form-select" id="eventDuration">
                                <option value="30">30 minutos</option>
                                <option value="60" selected>1 hora</option>
                                <option value="90">1h 30min</option>
                                <option value="120">2 horas</option>
                                <option value="180">3 horas</option>
                                <option value="240">4 horas</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">üìç Local</label>
                            <input type="text" class="form-input" id="eventLocation" placeholder="Ex: Sala de reuni√µes, Google Meet">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">üë• Participantes</label>
                        <input type="text" class="form-input" id="eventAttendees" placeholder="Ex: joao@email.com, maria@email.com">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">üìÑ Descri√ß√£o</label>
                        <textarea class="form-textarea" id="eventDescription" placeholder="Agenda, objetivos e observa√ß√µes do evento..."></textarea>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeQuickModal()">
                            Cancelar
                        </button>
                        <button type="submit" class="btn btn-primary">
                            üìÖ Criar Evento
                        </button>
                    </div>
                </form>
            </div>

            <!-- Tab IA Bulk -->
            <div class="tab-content" id="tab-bulk">
                <form id="bulkForm" onsubmit="createBulkTasks(event)">
                    <div class="form-group">
                        <label class="form-label">ü§ñ Descri√ß√£o do Projeto</label>
                        <textarea class="form-textarea" id="bulkDescription" placeholder="Ex: Preciso organizar o lan√ßamento de um novo produto. Inclui cria√ß√£o de materiais de marketing, coordena√ß√£o com equipe de vendas, prepara√ß√£o do evento de lan√ßamento..." required style="min-height: 120px;"></textarea>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">üè¢ Setor Principal</label>
                            <select class="form-select" id="bulkSetor" required>
                                <option value="">Selecionar setor</option>
                                <option value="Design">üé® Design</option>
                                <option value="Audiovisual">üé¨ Audiovisual</option>
                                <option value="Social Media">üì± Social Media</option>
                                <option value="Gest√£o de Projetos">üìä Gest√£o</option>
                                <option value="Est√∫dio">üéµ Est√∫dio</option>
                                <option value="M√∫sico">üé§ Artista</option>
                                <option value="Geral">üìã Geral</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">üìÖ Prazo Final</label>
                            <input type="date" class="form-input" id="bulkDeadline" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">‚ö° Prioridade Geral</label>
                        <select class="form-select" id="bulkPriority">
                            <option value="normal">üìå Normal</option>
                            <option value="high">üî• Alta</option>
                            <option value="urgent">üö® Urgente</option>
                            <option value="low">üìã Baixa</option>
                        </select>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeQuickModal()">
                            Cancelar
                        </button>
                        <button type="submit" class="btn btn-primary">
                            ü§ñ Gerar Demandas
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- ===============================
         üìÑ LOADING OVERLAY 
         =============================== -->
    <div class="loading" id="loading">
        <div class="loading-content">
            <div class="spinner"></div>
            <div class="loading-text">Processando...</div>
        </div>
    </div>

    <!-- ===============================
         üöÄ JAVASCRIPT 
         =============================== -->
    <script>
        // üîß CONFIGURA√á√ÉO - WEBHOOKS ATUALIZADOS PARA INDEX 3
        // Usando os mesmos endpoints do index 3
        const CONFIG = {
            N8N_BASE_URL: 'https://n8n-x8go8cgk0g0c0wc4004wosoc.themodernservers.com',
            ENDPOINTS: {
                EVENTS: '/webhook/dashboard-events',
                TASKS: '/webhook/clickup-tasks',
                UNIFIED: '/webhook/dashboard-unified',
                CREATE_TASK: '/webhook/dashboard-create-task',
                CREATE_EVENT: '/webhook/dashboard-create-event',
                CREATE_BULK_TASKS: '/webhook/dashboard-bulk-tasks',
                UPDATE_TASK_STATUS: '/webhook/dashboard-update-task-status',
                PROJECT_VIEW: '/webhook/dashboard-project-view' // NOVO: Visualiza√ß√£o completa de projetos
            },
            AUTO_SYNC: 300000 // 5 minutos
        };

        // üìÑ ESTADO GLOBAL
        let allEvents = [];
        let allTasks = [];
        let allProjectTasks = []; // NOVO: Todas as tarefas do projeto sem filtro de data
        let currentView = 'dashboard';
        let currentPeriod = 'dia';
        let projectViewMode = false; // NOVO: Modo de visualiza√ß√£o de projeto completo
        let lastSync = null;
        let currentFilters = {
            text: '',
            setor: '',
            date: '',
            priority: '',
            status: '', // NOVO: Filtro por status
            assignee: '' // NOVO: Filtro por respons√°vel
        };

        // üöÄ INICIALIZA√á√ÉO
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ MERACHI Dashboard iniciado com endpoints do index 3');
            initializeApp();
        });

        async function initializeApp() {
            showLoading(true);
            try {
                await loadAllData();
                setupEventListeners();
                setupAutoSync();
                
                // Garantir que come√ßamos na visualiza√ß√£o do dashboard
                currentView = 'dashboard';
                document.querySelector('.nav-item[onclick*="dashboard"]')?.classList.add('active');
                
                showNotification('MERACHI Dashboard carregado com sucesso! ü¶ã', 'success');
            } catch (error) {
                console.error('Erro na inicializa√ß√£o:', error);
                loadMockData();
                showNotification('Modo offline ativado', 'warning');
            } finally {
                showLoading(false);
            }
        }

        // ===============================
        // üìä CARREGAMENTO DE DADOS
        // ===============================

        async function loadAllData() {
            await Promise.all([
                loadCalendarEvents(),
                loadClickUpTasks()
            ]);
            updateMetrics();
            renderCurrentView();
            lastSync = new Date();
        }

        // NOVA FUN√á√ÉO: Carregar visualiza√ß√£o completa do projeto
        async function loadProjectView() {
            try {
                showLoading(true);
                const response = await fetch(`${CONFIG.N8N_BASE_URL}${CONFIG.ENDPOINTS.PROJECT_VIEW}`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();
                console.log('üåü Resposta do Project View:', data);

                if (data.success && data.projectTasks && Array.isArray(data.projectTasks)) {
                    allProjectTasks = data.projectTasks.map(task => ({
                        id: task.id || `task-${Date.now()}`,
                        title: task.title || task.name || 'Demanda sem nome',
                        description: task.description || '',
                        setor: task.setor || task.sector || 'Geral',
                        categoria: task.categoria || 'geral',
                        status: task.status || 'open',
                        assignees: task.assignees || [],
                        due_date: task.due_date,
                        start_date: task.start_date || task.start,
                        created_date: task.created_date,
                        url: task.url,
                        priority: task.priority || 'normal',
                        dependencies: task.dependencies || [],
                        project: task.project || 'Projeto Principal',
                        tags: task.tags || []
                    }));

                    console.log(`üåü ${allProjectTasks.length} tarefas do projeto carregadas`);
                    projectViewMode = true;
                    
                    // Atualizar UI
                    updateMetrics();
                    renderCurrentView();
                    showNotification(`Visualiza√ß√£o de projeto carregada! ${allProjectTasks.length} tarefas encontradas üåü`, 'success');
                    
                } else {
                    console.warn('‚ö†Ô∏è Estrutura inv√°lida do Project View:', data);
                    // Fallback: usar tarefas atuais
                    allProjectTasks = [...allTasks];
                    projectViewMode = true;
                    updateMetrics();
                    renderCurrentView();
                    showNotification('Usando dados atuais para visualiza√ß√£o de projeto', 'warning');
                }
            } catch (error) {
                console.error('‚ùå Erro ao carregar Project View:', error);
                // Fallback: usar tarefas atuais
                allProjectTasks = [...allTasks];
                projectViewMode = true;
                updateMetrics();
                renderCurrentView();
                showNotification('Modo offline: usando dados locais para projeto', 'warning');
            } finally {
                showLoading(false);
            }
        }

        async function loadCalendarEvents() {
            try {
                const response = await fetch(`${CONFIG.N8N_BASE_URL}${CONFIG.ENDPOINTS.EVENTS}`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();
                console.log('üìÖ Resposta do Calendar:', data);

                if (data.success && Array.isArray(data.events)) {
                    allEvents = data.events.map(event => ({
                        id: event.id || `event-${Date.now()}`,
                        title: event.title || event.summary || 'Evento sem t√≠tulo',
                        description: event.description || '',
                        start: event.start || event.startTime || new Date().toISOString(),
                        end: event.end || event.endTime,
                        location: event.location || '',
                        status: event.status || 'confirmed',
                        attendees: event.attendees || []
                    }));
                    console.log(`‚úÖ ${allEvents.length} eventos carregados`);
                } else {
                    console.warn('‚ö†Ô∏è Estrutura inv√°lida do Calendar:', data);
                    allEvents = generateMockEvents();
                }
            } catch (error) {
                console.error('‚ùå Erro ao carregar Calendar:', error);
                allEvents = generateMockEvents();
            }
        }

        async function loadClickUpTasks() {
            try {
                const response = await fetch(`${CONFIG.N8N_BASE_URL}${CONFIG.ENDPOINTS.TASKS}`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();
                console.log('üìù Resposta do ClickUp:', data);

                if (data.success && data.tasks && Array.isArray(data.tasks)) {
                    allTasks = data.tasks.map(task => ({
                        id: task.id || `task-${Date.now()}`,
                        title: task.title || task.name || 'Demanda sem nome',
                        description: task.description || '',
                        setor: task.setor || task.sector || 'Geral',
                        categoria: task.categoria || 'geral',
                        status: task.status || 'open',
                        assignees: task.assignees || [],
                        due_date: task.due_date,
                        start: task.start || new Date().toISOString(),
                        url: task.url,
                        priority: task.priority || 'normal'
                    }));

                    console.log(`‚úÖ ${allTasks.length} demandas processadas`);
                    console.log('üìã Primeira tarefa:', allTasks[0]);

                    const setoresEncontrados = [...new Set(allTasks.map(t => t.setor))].sort();
                    console.log('üè¢ Setores encontrados:', setoresEncontrados);

                } else {
                    console.warn('‚ö†Ô∏è Estrutura inv√°lida do ClickUp:', data);
                    allTasks = generateMockTasks();
                }
            } catch (error) {
                console.error('‚ùå Erro ao carregar ClickUp:', error);
                allTasks = generateMockTasks();
            }
        }

        // ===============================
        // üìù CRIA√á√ÉO DE DEMANDAS E EVENTOS
        // ===============================

        async function createQuickTask(event) {
            event.preventDefault();
            
            const submitBtn = event.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.innerHTML;
            
            try {
                submitBtn.disabled = true;
                submitBtn.classList.add('btn-loading');
                
                const taskData = {
                    title: document.getElementById('taskTitle').value,
                    setor: document.getElementById('taskSetor').value,
                    priority: document.getElementById('taskPriority').value,
                    due_date: document.getElementById('taskDueDate').value,
                    assignee: document.getElementById('taskAssignee').value,
                    description: document.getElementById('taskDescription').value,
                    status: 'open'
                };

                console.log('üìù Criando tarefa:', taskData);

                const response = await fetch(`${CONFIG.N8N_BASE_URL}${CONFIG.ENDPOINTS.CREATE_TASK}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(taskData)
                });

                const result = await response.json();
                console.log('‚úÖ Resposta da cria√ß√£o:', result);

                if (result.success) {
                    showNotification('Demanda criada com sucesso! üéâ', 'success');
                    closeQuickModal();
                    document.getElementById('taskForm').reset();
                    await loadClickUpTasks();
                    updateMetrics();
                    renderCurrentView();
                } else {
                    throw new Error(result.message || 'Erro ao criar demanda');
                }

            } catch (error) {
                console.error('‚ùå Erro ao criar tarefa:', error);
                showNotification('Erro ao criar demanda: ' + error.message, 'error');
            } finally {
                submitBtn.disabled = false;
                submitBtn.classList.remove('btn-loading');
                submitBtn.innerHTML = originalText;
            }
        }

        async function createQuickEvent(event) {
            event.preventDefault();
            
            const submitBtn = event.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.innerHTML;
            
            try {
                submitBtn.disabled = true;
                submitBtn.classList.add('btn-loading');
                
                const eventDate = document.getElementById('eventDate').value;
                const eventTime = document.getElementById('eventTime').value;
                const duration = parseInt(document.getElementById('eventDuration').value);
                
                const startDateTime = new Date(`${eventDate}T${eventTime}`);
                const endDateTime = new Date(startDateTime.getTime() + (duration * 60000));

                const eventData = {
                    title: document.getElementById('eventTitle').value,
                    start: startDateTime.toISOString(),
                    end: endDateTime.toISOString(),
                    location: document.getElementById('eventLocation').value,
                    description: document.getElementById('eventDescription').value,
                    attendees: document.getElementById('eventAttendees').value.split(',').map(email => email.trim()).filter(email => email)
                };

                console.log('üìÖ Criando evento:', eventData);

                const response = await fetch(`${CONFIG.N8N_BASE_URL}${CONFIG.ENDPOINTS.CREATE_EVENT}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(eventData)
                });

                const result = await response.json();
                console.log('‚úÖ Resposta da cria√ß√£o:', result);

                if (result.success) {
                    showNotification('Evento criado com sucesso! üéâ', 'success');
                    closeQuickModal();
                    document.getElementById('eventForm').reset();
                    await loadCalendarEvents();
                    updateMetrics();
                    renderCurrentView();
                } else {
                    throw new Error(result.message || 'Erro ao criar evento');
                }

            } catch (error) {
                console.error('‚ùå Erro ao criar evento:', error);
                showNotification('Erro ao criar evento: ' + error.message, 'error');
            } finally {
                submitBtn.disabled = false;
                submitBtn.classList.remove('btn-loading');
                submitBtn.innerHTML = originalText;
            }
        }

        async function createBulkTasks(event) {
            event.preventDefault();
            
            const submitBtn = event.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.innerHTML;
            
            try {
                submitBtn.disabled = true;
                submitBtn.classList.add('btn-loading');
                
                const bulkData = {
                    description: document.getElementById('bulkDescription').value,
                    setor: document.getElementById('bulkSetor').value,
                    deadline: document.getElementById('bulkDeadline').value,
                    priority: document.getElementById('bulkPriority').value
                };

                console.log('ü§ñ Criando tarefas em lote:', bulkData);

                const response = await fetch(`${CONFIG.N8N_BASE_URL}${CONFIG.ENDPOINTS.CREATE_BULK_TASKS}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(bulkData)
                });

                const result = await response.json();
                console.log('‚úÖ Resposta da cria√ß√£o em lote:', result);

                if (result.success) {
                    const tasksCount = result.tasks ? result.tasks.length : 'v√°rias';
                    showNotification(`${tasksCount} demandas criadas com IA! ü§ñ‚ú®`, 'success');
                    closeQuickModal();
                    document.getElementById('bulkForm').reset();
                    await loadClickUpTasks();
                    updateMetrics();
                    renderCurrentView();
                } else {
                    throw new Error(result.message || 'Erro ao criar demandas em lote');
                }

            } catch (error) {
                console.error('‚ùå Erro ao criar tarefas em lote:', error);
                showNotification('Erro ao gerar demandas: ' + error.message, 'error');
            } finally {
                submitBtn.disabled = false;
                submitBtn.classList.remove('btn-loading');
                submitBtn.innerHTML = originalText;
            }
        }

        // ===============================
        // üîÑ ATUALIZA√á√ÉO DE STATUS
        // ===============================

        async function changeTaskStatus(event, taskId) {
            event.stopPropagation();
            
            const badge = event.target;
            const originalText = badge.textContent;
            
            try {
                badge.classList.add('loading');
                
                const currentTask = allTasks.find(t => t.id === taskId);
                if (!currentTask) return;

                const statuses = ['open', 'progress', 'review', 'complete'];
                const currentIndex = statuses.indexOf(currentTask.status);
                const nextStatus = statuses[(currentIndex + 1) % statuses.length];

                const updateData = {
                    taskId: taskId,
                    status: nextStatus
                };

                console.log('üîÑ Atualizando status:', updateData);

                const response = await fetch(`${CONFIG.N8N_BASE_URL}${CONFIG.ENDPOINTS.UPDATE_TASK_STATUS}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(updateData)
                });

                const result = await response.json();

                if (result.success) {
                    currentTask.status = nextStatus;
                    renderCurrentView();
                    updateMetrics();
                    showNotification(`Status alterado para ${getTaskStatusLabel(nextStatus)}`, 'info');
                } else {
                    throw new Error(result.message || 'Erro ao atualizar status');
                }

            } catch (error) {
                console.error('‚ùå Erro ao atualizar status:', error);
                showNotification('Erro ao atualizar status: ' + error.message, 'error');
            } finally {
                badge.classList.remove('loading');
            }
        }

        async function resetTaskStatusButton(event, taskId) {
            event.stopPropagation();
            
            try {
                const updateData = {
                    taskId: taskId,
                    status: 'open'
                };

                console.log('üßπ Resetando status:', updateData);

                const response = await fetch(`${CONFIG.N8N_BASE_URL}${CONFIG.ENDPOINTS.UPDATE_TASK_STATUS}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(updateData)
                });

                const result = await response.json();

                if (result.success) {
                    const currentTask = allTasks.find(t => t.id === taskId);
                    if (currentTask) {
                        currentTask.status = 'open';
                        renderCurrentView();
                        updateMetrics();
                        showNotification('Status resetado para "Aberta" üßπ', 'info');
                    }
                } else {
                    throw new Error(result.message || 'Erro ao resetar status');
                }

            } catch (error) {
                console.error('‚ùå Erro ao resetar status:', error);
                showNotification('Erro ao resetar status: ' + error.message, 'error');
            }
        }

        // ===============================
        // üîÑ SINCRONIZA√á√ÉO
        // ===============================

        async function syncAll() {
            showLoading(true);
            try {
                // Tentar usar o webhook de sincroniza√ß√£o completa primeiro
                try {
                    const response = await fetch(`${CONFIG.N8N_BASE_URL}${CONFIG.ENDPOINTS.UNIFIED}`, {
                        method: 'GET',
                        headers: {
                            'Content-Type': 'application/json'
                        }
                    });

                    if (response.ok) {
                        const data = await response.json();
                        if (data.success) {
                            if (data.events) allEvents = data.events;
                            if (data.tasks) allTasks = data.tasks;
                            updateMetrics();
                            renderCurrentView();
                            lastSync = new Date();
                            showNotification('Sincroniza√ß√£o completa realizada! üîÑ‚ú®', 'success');
                            return;
                        }
                    }
                } catch (unifiedError) {
                    console.warn('Webhook unificado n√£o dispon√≠vel, usando sincroniza√ß√£o individual');
                }

                // Fallback para sincroniza√ß√£o individual
                await loadAllData();
                showNotification('Dados sincronizados com sucesso! üîÑ', 'success');

            } catch (error) {
                console.error('Erro na sincroniza√ß√£o:', error);
                showNotification('Erro na sincroniza√ß√£o: ' + error.message, 'error');
            } finally {
                showLoading(false);
            }
        }

        async function syncCalendar() {
            showLoading(true);
            try {
                await loadCalendarEvents();
                updateMetrics();
                renderCurrentView();
                showNotification('Eventos sincronizados! üìÖ', 'success');
            } catch (error) {
                console.error('Erro ao sincronizar calendar:', error);
                showNotification('Erro ao sincronizar eventos', 'error');
            } finally {
                showLoading(false);
            }
        }

        async function syncClickUp() {
            showLoading(true);
            try {
                await loadClickUpTasks();
                updateMetrics();
                renderCurrentView();
                showNotification('Demandas sincronizadas! ‚úÖ', 'success');
            } catch (error) {
                console.error('Erro ao sincronizar ClickUp:', error);
                showNotification('Erro ao sincronizar demandas', 'error');
            } finally {
                showLoading(false);
            }
        }

        // ===============================
        // üìä M√âTRICAS E RENDERIZA√á√ÉO
        // ===============================

        function updateMetrics() {
            const now = new Date();
            const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
            const weekStart = new Date(today);
            weekStart.setDate(today.getDate() - today.getDay());
            const weekEnd = new Date(weekStart);
            weekEnd.setDate(weekStart.getDate() + 7);

            // Total de eventos (agenda + demandas)
            const totalEvents = allEvents.length + allTasks.length;
            document.getElementById('totalEvents').textContent = totalEvents;

            // Conclu√≠dos esta semana
            const completed = allTasks.filter(task => {
                const isCompleted = task.status === 'complete' || task.status === 'closed';
                return isCompleted;
            }).length;
            document.getElementById('completed').textContent = completed;

            // Em progresso
            const inProgress = allTasks.filter(task => 
                task.status === 'progress' || task.status === 'in progress'
            ).length;
            document.getElementById('inProgress').textContent = inProgress;
        }

        function renderCurrentView() {
            const mainContent = document.getElementById('mainContent');
            
            switch(currentView) {
                case 'dashboard':
                    renderDashboardView();
                    break;
                case 'agenda':
                    renderAgendaView();
                    break;
                case 'demandas':
                    renderDemandasView();
                    break;
                case 'calendario':
                    renderCalendarioView();
                    break;
                case 'analytics':
                    renderAnalyticsView();
                    break;
                case 'automacao':
                    renderAutomacaoView();
                    break;
                case 'integracao':
                    renderIntegracaoView();
                    break;
                case 'equipe':
                    renderEquipeView();
                    break;
                case 'configuracoes':
                    renderConfiguracoesView();
                    break;
                default:
                    renderDashboardView();
            }
        }

        function renderDashboardView() {
            const contentArea = document.querySelector('.content-grid');
            if (contentArea) {
                contentArea.style.display = 'grid';
                renderCalendarEvents();
                renderClickUpTasks();
            }
            
            // Mostrar filtros e m√©tricas
            document.querySelector('.metrics-grid').style.display = 'grid';
            document.querySelector('.filters-section').style.display = 'block';
        }

        function renderAgendaView() {
            const mainContent = document.getElementById('mainContent');
            const contentAfterHeader = mainContent.querySelector('.metrics-grid').parentElement;
            
            // Ocultar m√©tricas e mostrar apenas filtros
            document.querySelector('.metrics-grid').style.display = 'none';
            document.querySelector('.filters-section').style.display = 'block';
            
            // Substituir content-grid por visualiza√ß√£o completa de agenda
            const contentGrid = contentAfterHeader.querySelector('.content-grid');
            contentGrid.style.display = 'none';
            
            let agendaContainer = document.getElementById('agendaFullView');
            if (!agendaContainer) {
                agendaContainer = document.createElement('div');
                agendaContainer.id = 'agendaFullView';
                agendaContainer.className = 'content-section';
                contentAfterHeader.appendChild(agendaContainer);
            }
            
            agendaContainer.style.display = 'block';
            agendaContainer.innerHTML = `
                <div class="section-header">
                    <h2 class="section-title">üìÖ Todos os Eventos da Agenda</h2>
                    <p class="section-subtitle">Visualiza√ß√£o completa dos compromissos do Google Calendar</p>
                    <div class="section-actions">
                        <button class="section-btn" onclick="syncCalendar()">üîÑ Sincronizar</button>
                        <button class="section-btn" onclick="addNewEvent()">‚ûï Novo Evento</button>
                    </div>
                </div>
                <div class="section-content" id="agendaFullContent">
                    ${getFilteredEvents().length > 0 ? 
                        getFilteredEvents().map(event => createEventHTML(event)).join('') : 
                        '<div class="empty-state"><h3>Nenhum evento encontrado</h3><p>N√£o h√° eventos para o per√≠odo selecionado</p></div>'
                    }
                </div>
            `;
        }

        function renderDemandasView() {
            const mainContent = document.getElementById('mainContent');
            const contentAfterHeader = mainContent.querySelector('.metrics-grid').parentElement;
            
            // Ocultar m√©tricas e mostrar apenas filtros
            document.querySelector('.metrics-grid').style.display = 'none';
            document.querySelector('.filters-section').style.display = 'block';
            
            // Substituir content-grid por visualiza√ß√£o completa de demandas
            const contentGrid = contentAfterHeader.querySelector('.content-grid');
            contentGrid.style.display = 'none';
            
            let demandasContainer = document.getElementById('demandasFullView');
            if (!demandasContainer) {
                demandasContainer = document.createElement('div');
                demandasContainer.id = 'demandasFullView';
                demandasContainer.className = 'content-section';
                contentAfterHeader.appendChild(demandasContainer);
            }
            
            demandasContainer.style.display = 'block';
            demandasContainer.innerHTML = `
                <div class="section-header">
                    <h2 class="section-title">‚úÖ Todas as Demandas Ativas</h2>
                    <p class="section-subtitle">Visualiza√ß√£o completa das tarefas organizadas por setor</p>
                    <div class="section-actions">
                        <button class="section-btn" onclick="syncClickUp()">üîÑ Sincronizar</button>
                        <button class="section-btn" onclick="addNewTask()">‚ûï Nova Demanda</button>
                    </div>
                </div>
                <div class="section-content" id="demandasFullContent">
                    ${getFilteredTasks().length > 0 ? 
                        renderTasksBySector(getFilteredTasks()) : 
                        '<div class="empty-state"><h3>Nenhuma demanda encontrada</h3><p>N√£o h√° demandas para os filtros selecionados</p></div>'
                    }
                </div>
            `;
        }

        function renderCalendarioView() {
            const mainContent = document.getElementById('mainContent');
            const contentAfterHeader = mainContent.querySelector('.metrics-grid').parentElement;
            
            // Ocultar m√©tricas e mostrar apenas filtros
            document.querySelector('.metrics-grid').style.display = 'none';
            document.querySelector('.filters-section').style.display = 'block';
            
            // Substituir content-grid por visualiza√ß√£o de calend√°rio
            const contentGrid = contentAfterHeader.querySelector('.content-grid');
            contentGrid.style.display = 'none';
            
            let calendarioContainer = document.getElementById('calendarioFullView');
            if (!calendarioContainer) {
                calendarioContainer = document.createElement('div');
                calendarioContainer.id = 'calendarioFullView';
                calendarioContainer.style.width = '100%';
                contentAfterHeader.appendChild(calendarioContainer);
            }
            
            calendarioContainer.style.display = 'block';
            renderCalendar();
        }

        function renderAnalyticsView() {
            const mainContent = document.getElementById('mainContent');
            const contentAfterHeader = mainContent.querySelector('.metrics-grid').parentElement;
            
            // Mostrar m√©tricas e ocultar filtros
            document.querySelector('.metrics-grid').style.display = 'grid';
            document.querySelector('.filters-section').style.display = 'none';
            const contentGrid = contentAfterHeader.querySelector('.content-grid');
            contentGrid.style.display = 'none';
            
            let analyticsContainer = document.getElementById('analyticsFullView');
            if (!analyticsContainer) {
                analyticsContainer = document.createElement('div');
                analyticsContainer.id = 'analyticsFullView';
                analyticsContainer.style.width = '100%';
                contentAfterHeader.appendChild(analyticsContainer);
            }
            
            analyticsContainer.style.display = 'block';
            
            // Calcular estat√≠sticas
            const stats = calculateAnalytics();
            
            analyticsContainer.innerHTML = `
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 32px; margin-bottom: 32px;">
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">üìä Distribui√ß√£o por Status</h2>
                            <p class="section-subtitle">Progresso geral das demandas</p>
                        </div>
                        <div class="section-content">
                            ${Object.entries(stats.byStatus).map(([status, data]) => `
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid var(--border-light);">
                                    <span style="display: flex; align-items: center; gap: 8px;">
                                        ${getTaskStatusIcon(status)} ${getTaskStatusLabel(status)}
                                    </span>
                                    <div style="display: flex; align-items: center; gap: 12px;">
                                        <div style="background: var(--bg-secondary); border-radius: 8px; width: 100px; height: 8px; overflow: hidden;">
                                            <div style="background: ${getStatusColor(status)}; height: 100%; width: ${data.percentage}%;"></div>
                                        </div>
                                        <strong>${data.count}</strong>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">üè¢ Distribui√ß√£o por Setor</h2>
                            <p class="section-subtitle">Carga de trabalho por equipe</p>
                        </div>
                        <div class="section-content">
                            ${Object.entries(stats.bySector).map(([sector, data]) => `
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid var(--border-light);">
                                    <span style="display: flex; align-items: center; gap: 8px;">
                                        ${getSectorIcon(sector)} ${sector}
                                    </span>
                                    <div style="display: flex; align-items: center; gap: 12px;">
                                        <div style="background: var(--bg-secondary); border-radius: 8px; width: 100px; height: 8px; overflow: hidden;">
                                            <div style="background: var(--primary); height: 100%; width: ${data.percentage}%;"></div>
                                        </div>
                                        <strong>${data.count}</strong>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
                
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">üìà M√©tricas de Produtividade</h2>
                        <p class="section-subtitle">Insights sobre performance da equipe</p>
                    </div>
                    <div class="section-content">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                            <div style="text-align: center; padding: 20px; background: var(--bg-secondary); border-radius: 12px;">
                                <div style="font-size: 2rem; margin-bottom: 8px;">‚ö°</div>
                                <div style="font-size: 1.5rem; font-weight: 700; color: var(--primary);">${stats.productivity.avgCompletionTime}</div>
                                <div style="font-size: 0.9rem; color: var(--text-muted);">Tempo M√©dio de Conclus√£o</div>
                            </div>
                            <div style="text-align: center; padding: 20px; background: var(--bg-secondary); border-radius: 12px;">
                                <div style="font-size: 2rem; margin-bottom: 8px;">üéØ</div>
                                <div style="font-size: 1.5rem; font-weight: 700; color: var(--success);">${stats.productivity.completionRate}%</div>
                                <div style="font-size: 0.9rem; color: var(--text-muted);">Taxa de Conclus√£o</div>
                            </div>
                            <div style="text-align: center; padding: 20px; background: var(--bg-secondary); border-radius: 12px;">
                                <div style="font-size: 2rem; margin-bottom: 8px;">üìã</div>
                                <div style="font-size: 1.5rem; font-weight: 700; color: var(--info);">${stats.productivity.totalTasks}</div>
                                <div style="font-size: 0.9rem; color: var(--text-muted);">Total de Demandas</div>
                            </div>
                            <div style="text-align: center; padding: 20px; background: var(--bg-secondary); border-radius: 12px;">
                                <div style="font-size: 2rem; margin-bottom: 8px;">üë•</div>
                                <div style="font-size: 1.5rem; font-weight: 700; color: var(--warning);">${stats.productivity.activeMembers}</div>
                                <div style="font-size: 0.9rem; color: var(--text-muted);">Membros Ativos</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderAutomacaoView() {
            const mainContent = document.getElementById('mainContent');
            const contentAfterHeader = mainContent.querySelector('.metrics-grid').parentElement;
            
            document.querySelector('.metrics-grid').style.display = 'none';
            document.querySelector('.filters-section').style.display = 'none';
            const contentGrid = contentAfterHeader.querySelector('.content-grid');
            contentGrid.style.display = 'none';
            
            let automacaoContainer = document.getElementById('automacaoFullView');
            if (!automacaoContainer) {
                automacaoContainer = document.createElement('div');
                automacaoContainer.id = 'automacaoFullView';
                automacaoContainer.style.width = '100%';
                contentAfterHeader.appendChild(automacaoContainer);
            }
            
            automacaoContainer.style.display = 'block';
            automacaoContainer.innerHTML = `
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">ü§ñ Automa√ß√µes n8n</h2>
                        <p class="section-subtitle">Fluxos automatizados e configura√ß√µes</p>
                        <div class="section-actions">
                            <button class="section-btn" onclick="testAutomations()">üß™ Testar Conex√µes</button>
                            <button class="section-btn" onclick="openN8nInterface()">üîß Abrir n8n</button>
                        </div>
                    </div>
                    <div class="section-content">
                        <div style="display: grid; gap: 20px;">
                            ${generateAutomationList()}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderIntegracaoView() {
            const mainContent = document.getElementById('mainContent');
            const contentAfterHeader = mainContent.querySelector('.metrics-grid').parentElement;
            
            document.querySelector('.metrics-grid').style.display = 'none';
            document.querySelector('.filters-section').style.display = 'none';
            const contentGrid = contentAfterHeader.querySelector('.content-grid');
            contentGrid.style.display = 'none';
            
            let integracaoContainer = document.getElementById('integracaoFullView');
            if (!integracaoContainer) {
                integracaoContainer = document.createElement('div');
                integracaoContainer.id = 'integracaoFullView';
                integracaoContainer.style.width = '100%';
                contentAfterHeader.appendChild(integracaoContainer);
            }
            
            integracaoContainer.style.display = 'block';
            integracaoContainer.innerHTML = `
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 32px;">
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">üîó Status das Integra√ß√µes</h2>
                            <p class="section-subtitle">Conex√µes com APIs externas</p>
                        </div>
                        <div class="section-content">
                            ${generateIntegrationStatus()}
                        </div>
                    </div>
                    
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">üìä Estat√≠sticas de Sync</h2>
                            <p class="section-subtitle">Performance das sincroniza√ß√µes</p>
                        </div>
                        <div class="section-content">
                            ${generateSyncStats()}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderEquipeView() {
            const mainContent = document.getElementById('mainContent');
            const contentAfterHeader = mainContent.querySelector('.metrics-grid').parentElement;
            
            document.querySelector('.metrics-grid').style.display = 'none';
            document.querySelector('.filters-section').style.display = 'block';
            const contentGrid = contentAfterHeader.querySelector('.content-grid');
            contentGrid.style.display = 'none';
            
            let equipeContainer = document.getElementById('equipeFullView');
            if (!equipeContainer) {
                equipeContainer = document.createElement('div');
                equipeContainer.id = 'equipeFullView';
                equipeContainer.style.width = '100%';
                contentAfterHeader.appendChild(equipeContainer);
            }
            
            equipeContainer.style.display = 'block';
            
            const teamStats = generateTeamStats();
            
            equipeContainer.innerHTML = `
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">üë• Membros da Equipe</h2>
                        <p class="section-subtitle">Vis√£o geral da equipe e suas demandas</p>
                        <div class="section-actions">
                            <button class="section-btn" onclick="exportTeamReport()">üìÑ Exportar Relat√≥rio</button>
                            <button class="section-btn" onclick="addTeamMember()">‚ûï Adicionar Membro</button>
                        </div>
                    </div>
                    <div class="section-content">
                        <div style="display: grid; gap: 16px;">
                            ${teamStats.map(member => `
                                <div style="background: var(--bg-secondary); padding: 20px; border-radius: 12px; border: 1px solid var(--border-light);">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                                        <div style="display: flex; align-items: center; gap: 12px;">
                                            <div style="width: 40px; height: 40px; background: var(--gradient-primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: 700;">
                                                ${member.name.charAt(0)}
                                            </div>
                                            <div>
                                                <div style="font-weight: 700; color: var(--text-primary);">${member.name}</div>
                                                <div style="font-size: 0.85rem; color: var(--text-muted);">${member.sector} ‚Ä¢ ${member.role}</div>
                                            </div>
                                        </div>
                                        <div style="text-align: right;">
                                            <div style="font-size: 1.2rem; font-weight: 700; color: var(--primary);">${member.activeTasks}</div>
                                            <div style="font-size: 0.8rem; color: var(--text-muted);">Ativas</div>
                                        </div>
                                    </div>
                                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; font-size: 0.85rem;">
                                        <div style="text-align: center; padding: 8px; background: var(--card-bg); border-radius: 6px;">
                                            <div style="font-weight: 600; color: var(--success);">${member.completed}</div>
                                            <div style="color: var(--text-muted);">Completas</div>
                                        </div>
                                        <div style="text-align: center; padding: 8px; background: var(--card-bg); border-radius: 6px;">
                                            <div style="font-weight: 600; color: var(--warning);">${member.inProgress}</div>
                                            <div style="color: var(--text-muted);">Em Progresso</div>
                                        </div>
                                        <div style="text-align: center; padding: 8px; background: var(--card-bg); border-radius: 6px;">
                                            <div style="font-weight: 600; color: var(--info);">${member.review}</div>
                                            <div style="color: var(--text-muted);">Revis√£o</div>
                                        </div>
                                        <div style="text-align: center; padding: 8px; background: var(--card-bg); border-radius: 6px;">
                                            <div style="font-weight: 600; color: var(--error);">${member.overdue}</div>
                                            <div style="color: var(--text-muted);">Atrasadas</div>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderConfiguracoesView() {
            const mainContent = document.getElementById('mainContent');
            const contentAfterHeader = mainContent.querySelector('.metrics-grid').parentElement;
            
            document.querySelector('.metrics-grid').style.display = 'none';
            document.querySelector('.filters-section').style.display = 'none';
            const contentGrid = contentAfterHeader.querySelector('.content-grid');
            contentGrid.style.display = 'none';
            
            let configContainer = document.getElementById('configFullView');
            if (!configContainer) {
                configContainer = document.createElement('div');
                configContainer.id = 'configFullView';
                configContainer.style.width = '100%';
                contentAfterHeader.appendChild(configContainer);
            }
            
            configContainer.style.display = 'block';
            configContainer.innerHTML = `
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 32px;">
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">üé® Prefer√™ncias Visuais</h2>
                            <p class="section-subtitle">Personalize a apar√™ncia do dashboard</p>
                        </div>
                        <div class="section-content">
                            <div style="display: grid; gap: 20px;">
                                <div>
                                    <label style="display: block; font-weight: 600; margin-bottom: 8px;">üåô Tema</label>
                                    <div style="display: flex; gap: 12px;">
                                        <button class="section-btn" onclick="setTheme('light')" style="flex: 1;">‚òÄÔ∏è Claro</button>
                                        <button class="section-btn" onclick="setTheme('dark')" style="flex: 1;">üåô Escuro</button>
                                        <button class="section-btn" onclick="setTheme('auto')" style="flex: 1;">üîÑ Auto</button>
                                    </div>
                                </div>
                                
                                <div>
                                    <label style="display: block; font-weight: 600; margin-bottom: 8px;">üîÑ Auto-sincroniza√ß√£o</label>
                                    <select class="filter-select" onchange="updateSyncInterval(this.value)">
                                        <option value="300000">5 minutos</option>
                                        <option value="600000">10 minutos</option>
                                        <option value="1800000">30 minutos</option>
                                        <option value="3600000">1 hora</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label style="display: block; font-weight: 600; margin-bottom: 8px;">üì± Notifica√ß√µes</label>
                                    <div style="display: grid; gap: 8px;">
                                        <label style="display: flex; align-items: center; gap: 8px; font-size: 0.9rem;">
                                            <input type="checkbox" checked> Sincroniza√ß√µes bem-sucedidas
                                        </label>
                                        <label style="display: flex; align-items: center; gap: 8px; font-size: 0.9rem;">
                                            <input type="checkbox" checked> Erros e falhas
                                        </label>
                                        <label style="display: flex; align-items: center; gap: 8px; font-size: 0.9rem;">
                                            <input type="checkbox"> Tarefas vencendo hoje
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">üîß Configura√ß√µes T√©cnicas</h2>
                            <p class="section-subtitle">Ajustes de conex√£o e performance</p>
                        </div>
                        <div class="section-content">
                            <div style="display: grid; gap: 20px;">
                                <div>
                                    <label style="display: block; font-weight: 600; margin-bottom: 8px;">üåê URL do n8n</label>
                                    <input type="text" class="filter-input" value="${CONFIG.N8N_BASE_URL}" placeholder="https://n8n.exemplo.com">
                                </div>
                                
                                <div>
                                    <label style="display: block; font-weight: 600; margin-bottom: 8px;">‚ö° Performance</label>
                                    <div style="background: var(--bg-secondary); padding: 16px; border-radius: 8px; font-size: 0.9rem;">
                                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                            <span>√öltima sincroniza√ß√£o:</span>
                                            <span>${lastSync ? lastSync.toLocaleString('pt-BR') : 'Nunca'}</span>
                                        </div>
                                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                            <span>Total de eventos:</span>
                                            <span>${allEvents.length}</span>
                                        </div>
                                        <div style="display: flex; justify-content: space-between;">
                                            <span>Total de demandas:</span>
                                            <span>${allTasks.length}</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div>
                                    <label style="display: block; font-weight: 600; margin-bottom: 8px;">üßπ Manuten√ß√£o</label>
                                    <div style="display: grid; gap: 8px;">
                                        <button class="section-btn" onclick="clearCache()">üóëÔ∏è Limpar Cache</button>
                                        <button class="section-btn" onclick="exportSettings()">üì• Exportar Configura√ß√µes</button>
                                        <button class="section-btn" onclick="resetSettings()">üîÑ Restaurar Padr√µes</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderPlaceholderView(title, subtitle, description) {
            const mainContent = document.getElementById('mainContent');
            const contentAfterHeader = mainContent.querySelector('.metrics-grid').parentElement;
            
            // Ocultar componentes do dashboard
            document.querySelector('.metrics-grid').style.display = 'none';
            document.querySelector('.filters-section').style.display = 'none';
            const contentGrid = contentAfterHeader.querySelector('.content-grid');
            contentGrid.style.display = 'none';
            
            let placeholderContainer = document.getElementById('placeholderView');
            if (!placeholderContainer) {
                placeholderContainer = document.createElement('div');
                placeholderContainer.id = 'placeholderView';
                placeholderContainer.className = 'content-section';
                contentAfterHeader.appendChild(placeholderContainer);
            }
            
            placeholderContainer.style.display = 'block';
            placeholderContainer.innerHTML = `
                <div class="section-header">
                    <h2 class="section-title">${title}</h2>
                    <p class="section-subtitle">${subtitle}</p>
                </div>
                <div class="section-content">
                    <div class="empty-state">
                        <h3>${description}</h3>
                        <p>Esta funcionalidade ser√° implementada em breve.</p>
                        <button class="btn btn-primary" onclick="showView('dashboard')" style="margin-top: 20px;">
                            üìä Voltar ao Dashboard
                        </button>
                    </div>
                </div>
            `;
        }

        function renderCalendarEvents() {
            const container = document.getElementById('calendarEvents');
            const filteredEvents = getFilteredEvents();

            if (filteredEvents.length === 0) {
                container.innerHTML = '<div class="empty-state"><h3>Nenhum evento encontrado</h3><p>N√£o h√° eventos para o per√≠odo selecionado</p></div>';
                return;
            }

            const html = filteredEvents.map(event => createEventHTML(event)).join('');
            container.innerHTML = html;
        }

        function renderClickUpTasks() {
            const container = document.getElementById('clickupTasks');
            const filteredTasks = getFilteredTasks();

            if (filteredTasks.length === 0) {
                container.innerHTML = '<div class="empty-state"><h3>Nenhuma demanda encontrada</h3><p>N√£o h√° demandas para os filtros selecionados</p></div>';
                return;
            }

            const html = renderTasksBySector(filteredTasks);
            container.innerHTML = html;
        }

        function renderTasksBySector(tasks) {
            const tasksPorSetor = {};
            
            tasks.forEach(task => {
                const setor = task.setor || task.sector || 'Geral';
                
                if (!tasksPorSetor[setor]) {
                    tasksPorSetor[setor] = [];
                }
                tasksPorSetor[setor].push(task);
            });

            const setoresOrdenados = Object.keys(tasksPorSetor).sort((a, b) => {
                const ordem = ['Design', 'Audiovisual', 'Social Media', 'Gest√£o de Projetos', 'Est√∫dio', 'M√∫sico', 'Geral'];
                const indexA = ordem.indexOf(a);
                const indexB = ordem.indexOf(b);
                
                if (indexA !== -1 && indexB !== -1) return indexA - indexB;
                if (indexA !== -1) return -1;
                if (indexB !== -1) return 1;
                return a.localeCompare(b);
            });

            console.log('üè¢ Setores processados:', setoresOrdenados);
            console.log('üìä Tasks por setor:', Object.fromEntries(
                setoresOrdenados.map(setor => [setor, tasksPorSetor[setor].length])
            ));

            let html = '';
            setoresOrdenados.forEach(setor => {
                const sectorTasks = tasksPorSetor[setor];
                if (sectorTasks.length > 0) {
                    html += `
                        <div class="sector-section">
                            <div class="sector-title">
                                ${getSectorIcon(setor)} <strong class="sector-name">${setor.toUpperCase()}</strong>
                                <span class="sector-count">${sectorTasks.length}</span>
                            </div>
                            ${sectorTasks.map(task => createTaskHTML(task)).join('')}
                        </div>
                    `;
                }
            });

            return html || '<div class="empty-state">Nenhuma demanda encontrada</div>';
        }

        function getSectorIcon(setor) {
            const icons = {
                'Design': 'üé®',
                'Audiovisual': 'üé¨',
                'Social Media': 'üì±',
                'Gest√£o de Projetos': 'üìä',
                'Est√∫dio': 'üéµ',
                'Est√∫dio ': 'üéµ',
                'M√∫sico': 'üé§',
                'Geral': 'üìã'
            };
            return icons[setor] || icons[setor.trim()] || 'üìã';
        }

        function createEventHTML(event) {
            const date = new Date(event.start);
            const timeStr = date.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
            const dateStr = date.toLocaleDateString('pt-BR');
            
            return `
                <div class="event-item" onclick="openEvent('${event.id}')">
                    <div class="item-title">${event.title}</div>
                    <div class="item-meta">
                        <span>üïê ${timeStr} - ${dateStr}</span>
                        ${event.location ? `<span>üìç ${event.location}</span>` : ''}
                        <span class="status-badge status-${event.status}" onclick="changeEventStatus(event, '${event.id}')">${getStatusLabel(event.status)}</span>
                    </div>
                </div>
            `;
        }

        function createTaskHTML(task) {
            let dueDateHTML = '';
            if (task.due_date || task.dueDate) {
                const dueDate = new Date(task.due_date || task.dueDate);
                const now = new Date();
                const isOverdue = dueDate < now;
                const isToday = dueDate.toDateString() === now.toDateString();
                const isTomorrow = dueDate.toDateString() === new Date(now.getTime() + 24 * 60 * 60 * 1000).toDateString();
                
                let dueDateText = dueDate.toLocaleDateString('pt-BR', { 
                    day: '2-digit', 
                    month: '2-digit',
                    year: '2-digit'
                });
                
                let dueDateClass = '';
                let dueDateIcon = 'üìÖ';
                
                if (isOverdue) {
                    dueDateClass = 'style="color: #DC2626; font-weight: 600;"';
                    dueDateIcon = 'üî¥';
                    dueDateText = `${dueDateText} (Vencida)`;
                } else if (isToday) {
                    dueDateClass = 'style="color: #D97706; font-weight: 600;"';
                    dueDateIcon = '‚ö°';
                    dueDateText = `${dueDateText} (Hoje)`;
                } else if (isTomorrow) {
                    dueDateClass = 'style="color: #059669; font-weight: 600;"';
                    dueDateIcon = 'üìç';
                    dueDateText = `${dueDateText} (Amanh√£)`;
                }
                
                dueDateHTML = `<span ${dueDateClass}>${dueDateIcon} ${dueDateText}</span>`;
            }

            let descriptionHTML = '';
            if (task.description && task.description.trim()) {
                const maxLength = 120;
                let description = task.description.trim();
                if (description.length > maxLength) {
                    description = description.substring(0, maxLength) + '...';
                }
                descriptionHTML = `<div style="font-size: 0.8rem; color: var(--text-light); margin-top: 6px; line-height: 1.4;">${description}</div>`;
            }

            // Mostrar borracha apenas se N√ÉO estiver em 'open'
            const showResetBtn = task.status !== 'open';

            return `
                <div class="task-item">
                    <div class="item-title">${task.title}</div>
                    <div class="item-meta">
                        ${task.assignees?.length ? `<span>üë§ ${task.assignees.join(', ')}</span>` : ''}
                        ${dueDateHTML}
                        <span class="status-badge status-${task.status}" 
                              onclick="changeTaskStatus(event, '${task.id}')"
                              title="üëÜ Clique: Avan√ßar status | üëÜüëÜ Duplo clique: Resetar para 'Aberta'"
                              style="cursor: pointer;">
                            ${getTaskStatusLabel(task.status)}
                        </span>
                        ${showResetBtn ? `
                            <button class="reset-btn" 
                                    onclick="resetTaskStatusButton(event, '${task.id}')" 
                                    title="üßπ Resetar para 'Aberta'">
                                üßπ
                            </button>
                        ` : ''}
                        ${task.url ? `<span style="font-size: 0.7rem;">üîó <a href="${task.url}" target="_blank" style="color: inherit; text-decoration: none;">ClickUp</a></span>` : ''}
                    </div>
                    ${descriptionHTML}
                </div>
            `;
        }

        // ===============================
        // üîç FILTROS MELHORADOS
        // ===============================

        function getFilteredEvents() {
            let filtered = projectViewMode ? allEvents : filterByPeriod(allEvents);
            return applyAdvancedFilters(filtered, 'event');
        }

        function getFilteredTasks() {
            let filtered;
            
            if (projectViewMode) {
                // Usar todas as tarefas do projeto
                filtered = [...allProjectTasks];
            } else {
                // Usar filtro de per√≠odo normal
                filtered = filterByPeriod(allTasks);
            }
            
            return applyAdvancedFilters(filtered, 'task');
        }

        function applyAdvancedFilters(items, type) {
            let filtered = [...items];
            
            // Filtro por texto
            if (currentFilters.text) {
                const searchText = currentFilters.text.toLowerCase();
                filtered = filtered.filter(item => 
                    item.title.toLowerCase().includes(searchText) ||
                    (item.description && item.description.toLowerCase().includes(searchText)) ||
                    (item.assignees && item.assignees.some(assignee => 
                        assignee.toLowerCase().includes(searchText)
                    ))
                );
            }
            
            // Filtro por setor (apenas para tarefas)
            if (currentFilters.setor && type === 'task') {
                filtered = filtered.filter(item => item.setor === currentFilters.setor);
            }
            
            // Filtro por status (apenas para tarefas)
            if (currentFilters.status && type === 'task') {
                filtered = filtered.filter(item => item.status === currentFilters.status);
            }
            
            // Filtro por respons√°vel (apenas para tarefas)
            if (currentFilters.assignee && type === 'task') {
                const assigneeText = currentFilters.assignee.toLowerCase();
                filtered = filtered.filter(item => 
                    item.assignees && item.assignees.some(assignee => 
                        assignee.toLowerCase().includes(assigneeText)
                    )
                );
            }
            
            // Filtro por data espec√≠fica (apenas se n√£o estiver em modo projeto)
            if (currentFilters.date && !projectViewMode) {
                const filterDate = new Date(currentFilters.date).toDateString();
                filtered = filtered.filter(item => {
                    const itemDate = new Date(item.start || item.due_date).toDateString();
                    return itemDate === filterDate;
                });
            }
            
            // Filtro por prioridade (apenas para tarefas)
            if (currentFilters.priority && type === 'task') {
                filtered = filtered.filter(item => item.priority === currentFilters.priority);
            }
            
            return filtered;
        }

        function filterByPeriod(items) {
            if (currentPeriod === 'todas' || projectViewMode) {
                return items; // Retornar todos os itens
            }

            const now = new Date();
            let startDate, endDate;

            switch(currentPeriod) {
                case 'dia':
                    startDate = new Date(now.getFullYear(), now.getMonth(), now.getDate());
                    endDate = new Date(startDate.getTime() + 24 * 60 * 60 * 1000);
                    break;
                case 'semana':
                    const weekStart = new Date(now);
                    weekStart.setDate(now.getDate() - now.getDay());
                    weekStart.setHours(0, 0, 0, 0);
                    startDate = weekStart;
                    endDate = new Date(weekStart.getTime() + 7 * 24 * 60 * 60 * 1000);
                    break;
                case 'mes':
                    startDate = new Date(now.getFullYear(), now.getMonth(), 1);
                    endDate = new Date(now.getFullYear(), now.getMonth() + 1, 1);
                    break;
                default:
                    return items; // Sem filtro de per√≠odo
            }

            return items.filter(item => {
                const itemDate = new Date(item.start || item.due_date);
                return itemDate >= startDate && itemDate < endDate;
            });
        }

        function applyFilters() {
            currentFilters.text = document.getElementById('filterText').value.toLowerCase();
            currentFilters.setor = document.getElementById('filterSetor').value;
            currentFilters.status = document.getElementById('filterStatus').value;
            currentFilters.assignee = document.getElementById('filterAssignee').value.toLowerCase();
            currentFilters.date = document.getElementById('filterDate').value;
            currentFilters.priority = document.getElementById('filterPriority').value;
            
            renderCurrentView();
            updateMetrics();
        }

        function clearAllFilters() {
            document.getElementById('filterText').value = '';
            document.getElementById('filterSetor').value = '';
            document.getElementById('filterStatus').value = '';
            document.getElementById('filterAssignee').value = '';
            document.getElementById('filterDate').value = '';
            document.getElementById('filterPriority').value = '';
            
            currentFilters = { text: '', setor: '', status: '', assignee: '', date: '', priority: '' };
            
            renderCurrentView();
            updateMetrics();
            
            showNotification('üßπ Filtros limpos', 'info');
        }

        // NOVA FUN√á√ÉO: Toggle visualiza√ß√£o de projeto
        async function toggleProjectView() {
            if (!projectViewMode) {
                await loadProjectView();
            } else {
                projectViewMode = false;
                allProjectTasks = [];
                updateMetrics();
                renderCurrentView();
                showNotification('Voltou para visualiza√ß√£o normal üìÖ', 'info');
            }
        }

        // ===============================
        // üéØ HELPERS
        // ===============================

        function getStatusLabel(status) {
            const labels = {
                'confirmed': '‚úÖ Confirmado',
                'tentative': '‚è≥ Tentativo',
                'cancelled': '‚ùå Cancelado'
            };
            return labels[status] || status;
        }

        function getTaskStatusLabel(status) {
            const labels = {
                'open': 'üìã Aberta',
                'Open': 'üìã Aberta',
                'progress': '‚ö° Em Progresso',
                'in progress': '‚ö° Em Progresso',
                'review': 'üëÄ Revis√£o',
                'complete': '‚úÖ Completa',
                'closed': '‚úÖ Fechada'
            };
            return labels[status] || `üìù ${status}`;
        }

        // ===============================
        // üîÑ AUTO-SYNC
        // ===============================

        function setupAutoSync() {
            setInterval(async () => {
                console.log('üîÑ Auto-sync executado');
                await loadAllData();
            }, CONFIG.AUTO_SYNC);
        }

        // ===============================
        // üé® UI HELPERS
        // ===============================

        function showView(viewName) {
            // Ocultar todas as visualiza√ß√µes especiais
            const specialViews = ['agendaFullView', 'demandasFullView', 'calendarioFullView', 'placeholderView'];
            specialViews.forEach(viewId => {
                const view = document.getElementById(viewId);
                if (view) {
                    view.style.display = 'none';
                }
            });
            
            // Atualizar navega√ß√£o ativa - procurar por todos os nav-items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
                
                // Verificar se este item corresponde √† view atual
                const onclick = item.getAttribute('onclick');
                if (onclick && onclick.includes(`'${viewName}'`)) {
                    item.classList.add('active');
                }
            });
            
            currentView = viewName;
            renderCurrentView();
            
            // Atualizar e mostrar indicador de visualiza√ß√£o
            const viewNames = {
                'dashboard': 'üìä Dashboard Principal',
                'agenda': 'üìÖ Visualiza√ß√£o de Agenda',
                'demandas': '‚úÖ Visualiza√ß√£o de Demandas', 
                'calendario': 'üóìÔ∏è Visualiza√ß√£o de Calend√°rio',
                'analytics': 'üìà Analytics',
                'automacao': 'ü§ñ Automa√ß√£o',
                'integracao': 'üîó Integra√ß√µes',
                'equipe': 'üë• Equipe',
                'configuracoes': '‚öôÔ∏è Configura√ß√µes'
            };
            
            if (viewNames[viewName]) {
                showViewIndicator(viewNames[viewName]);
                showNotification(`Navegando para: ${viewNames[viewName]}`, 'info');
            }
        }

        function showViewIndicator(viewName) {
            const indicator = document.getElementById('viewIndicator');
            if (indicator) {
                indicator.textContent = viewName;
                indicator.classList.add('show');
                
                // Ocultar ap√≥s 3 segundos
                setTimeout(() => {
                    indicator.classList.remove('show');
                }, 3000);
            }
        }

        function setPeriod(period) {
            document.querySelectorAll('.period-tab').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            currentPeriod = period;
            
            // Mostrar/ocultar controles de visualiza√ß√£o de projeto
            const projectControls = document.getElementById('projectViewControls');
            if (period === 'todas') {
                projectControls.style.display = 'block';
                // Se ainda n√£o estiver em modo projeto, ativar
                if (!projectViewMode) {
                    showNotification('üí° Ative a "Visualiza√ß√£o Completa de Projeto" para ver todas as tarefas no calend√°rio!', 'info');
                }
            } else {
                projectControls.style.display = 'none';
                // Se estava em modo projeto, desativar
                if (projectViewMode) {
                    projectViewMode = false;
                    allProjectTasks = [];
                    showNotification('üìÖ Voltou para visualiza√ß√£o por per√≠odo', 'info');
                }
            }
            
            renderCurrentView();
            updateMetrics();
        }

        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('open');
        }

        function toggleTheme() {
            const body = document.body;
            const themeToggle = document.getElementById('themeToggle');
            
            if (body.getAttribute('data-theme') === 'dark') {
                body.setAttribute('data-theme', 'light');
                themeToggle.textContent = 'üåô';
            } else {
                body.setAttribute('data-theme', 'dark');
                themeToggle.textContent = '‚òÄÔ∏è';
            }
        }

        // ===============================
        // üìÑ MODAL MANAGEMENT
        // ===============================

        function toggleQuickModal() {
            const modal = document.getElementById('quickModal');
            modal.classList.toggle('active');
        }

        function closeQuickModal() {
            document.getElementById('quickModal').classList.remove('active');
        }

        function closeModalOnBackdrop(event) {
            if (event.target === event.currentTarget) {
                closeQuickModal();
            }
        }

        function switchTab(tabName) {
            // Remover active de todos os bot√µes e conte√∫dos
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // Ativar o bot√£o e conte√∫do selecionado
            document.getElementById(`tab-${tabName}-btn`).classList.add('active');
            document.getElementById(`tab-${tabName}`).classList.add('active');
        }

        // ===============================
        // üéØ EVENT LISTENERS
        // ===============================

        function setupEventListeners() {
            // Fechar modal com ESC
            document.addEventListener('keydown', function(event) {
                if (event.key === 'Escape') {
                    closeQuickModal();
                    closeDayDetails();
                }
                
                // Atalhos de teclado para navega√ß√£o (Ctrl + n√∫mero)
                if (event.ctrlKey || event.metaKey) {
                    switch(event.key) {
                        case '1':
                            event.preventDefault();
                            showView('dashboard');
                            break;
                        case '2':
                            event.preventDefault();
                            showView('agenda');
                            break;
                        case '3':
                            event.preventDefault();
                            showView('demandas');
                            break;
                        case '4':
                            event.preventDefault();
                            showView('calendario');
                            break;
                    }
                }
            });

            // Auto-save de formul√°rios
            document.querySelectorAll('input, select, textarea').forEach(input => {
                input.addEventListener('change', function() {
                    // Salvar no localStorage se necess√°rio
                });
            });
            
            // Mostrar tooltips para atalhos de teclado
            setTimeout(() => {
                showNotification('üí° Dica: Use Ctrl+1,2,3,4 para navegar rapidamente!', 'info');
            }, 5000);
        }

        // ===============================
        // üéØ UTILITY FUNCTIONS
        // ===============================

        function showLoading(show) {
            const loading = document.getElementById('loading');
            if (show) {
                loading.classList.add('active');
            } else {
                loading.classList.remove('active');
            }
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            // Auto-remove ap√≥s 3 segundos
            setTimeout(() => {
                notification.remove();
            }, 3000);
            
            // Remove ao clicar
            notification.addEventListener('click', () => {
                notification.remove();
            });
        }

        // ===============================
        // üéØ MOCK DATA (FALLBACK)
        // ===============================

        function loadMockData() {
            allEvents = generateMockEvents();
            allTasks = generateMockTasks();
            updateMetrics();
            renderCurrentView();
        }

        function generateMockEvents() {
            const now = new Date();
            return [
                {
                    id: '1',
                    title: 'Reuni√£o de Planejamento',
                    description: 'Discuss√£o sobre pr√≥ximos projetos',
                    start: new Date(now.getTime() + 2 * 60 * 60 * 1000).toISOString(),
                    status: 'confirmed',
                    location: 'Sala de Reuni√µes'
                },
                {
                    id: '2',
                    title: 'Apresenta√ß√£o para Cliente',
                    description: 'Apresentar proposta final',
                    start: new Date(now.getTime() + 6 * 60 * 60 * 1000).toISOString(),
                    status: 'confirmed',
                    location: 'Google Meet'
                }
            ];
        }

        function generateMockTasks() {
            return [
                {
                    id: '1',
                    title: 'Finalizar design da landing page',
                    description: 'Criar vers√£o responsiva',
                    setor: 'Design',
                    status: 'progress',
                    assignees: ['Jo√£o'],
                    priority: 'high',
                    start: new Date().toISOString()
                },
                {
                    id: '2',
                    title: 'Revisar conte√∫do do blog',
                    description: 'Verificar SEO e gram√°tica',
                    setor: 'Social Media',
                    status: 'open',
                    assignees: ['Maria'],
                    priority: 'normal',
                    start: new Date().toISOString()
                }
            ];
        }

        // ===============================
        // üìä FUN√á√ïES AUXILIARES PARA ANALYTICS E VIEWS
        // ===============================

        function calculateAnalytics() {
            const totalTasks = allTasks.length;
            
            // Distribui√ß√£o por status
            const statusCount = {};
            allTasks.forEach(task => {
                const status = task.status || 'open';
                statusCount[status] = (statusCount[status] || 0) + 1;
            });
            
            const byStatus = {};
            Object.entries(statusCount).forEach(([status, count]) => {
                byStatus[status] = {
                    count,
                    percentage: totalTasks > 0 ? Math.round((count / totalTasks) * 100) : 0
                };
            });
            
            // Distribui√ß√£o por setor
            const sectorCount = {};
            allTasks.forEach(task => {
                const sector = task.setor || 'Geral';
                sectorCount[sector] = (sectorCount[sector] || 0) + 1;
            });
            
            const bySector = {};
            Object.entries(sectorCount).forEach(([sector, count]) => {
                bySector[sector] = {
                    count,
                    percentage: totalTasks > 0 ? Math.round((count / totalTasks) * 100) : 0
                };
            });
            
            // M√©tricas de produtividade
            const completedTasks = allTasks.filter(t => t.status === 'complete' || t.status === 'closed').length;
            const completionRate = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;
            
            const activeMembers = new Set(
                allTasks.filter(t => t.assignees && t.assignees.length > 0)
                       .flatMap(t => t.assignees)
            ).size;
            
            return {
                byStatus,
                bySector,
                productivity: {
                    totalTasks,
                    completionRate,
                    avgCompletionTime: '3.2 dias',
                    activeMembers
                }
            };
        }

        function getStatusColor(status) {
            const colors = {
                'open': '#6B7280',
                'progress': '#F59E0B',
                'review': '#3B82F6',
                'complete': '#10B981',
                'closed': '#10B981'
            };
            return colors[status] || '#6B7280';
        }

        function generateAutomationList() {
            const automations = [
                {
                    name: 'Sync Google Calendar ‚Üí Dashboard',
                    status: 'active',
                    lastRun: '2 min atr√°s',
                    endpoint: CONFIG.ENDPOINTS.EVENTS,
                    description: 'Sincroniza eventos do Google Calendar'
                },
                {
                    name: 'Sync ClickUp ‚Üí Dashboard',
                    status: 'active', 
                    lastRun: '5 min atr√°s',
                    endpoint: CONFIG.ENDPOINTS.TASKS,
                    description: 'Sincroniza tarefas do ClickUp'
                },
                {
                    name: 'Criar Tarefa via Dashboard',
                    status: 'active',
                    lastRun: '15 min atr√°s',
                    endpoint: CONFIG.ENDPOINTS.CREATE_TASK,
                    description: 'Cria novas tarefas no ClickUp'
                },
                {
                    name: 'Atualizar Status de Tarefa',
                    status: 'active',
                    lastRun: '8 min atr√°s',
                    endpoint: CONFIG.ENDPOINTS.UPDATE_TASK_STATUS,
                    description: 'Atualiza status das tarefas'
                },
                {
                    name: 'IA Bulk Tasks Generator',
                    status: 'active',
                    lastRun: '1 hora atr√°s',
                    endpoint: CONFIG.ENDPOINTS.CREATE_BULK_TASKS,
                    description: 'Gera tarefas automaticamente com IA'
                }
            ];
            
            return automations.map(auto => `
                <div style="background: var(--bg-secondary); padding: 20px; border-radius: 12px; border: 1px solid var(--border-light);">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                        <div>
                            <h3 style="margin: 0 0 4px 0; font-size: 1rem; color: var(--text-primary);">${auto.name}</h3>
                            <p style="margin: 0; font-size: 0.85rem; color: var(--text-muted);">${auto.description}</p>
                        </div>
                        <span style="background: ${auto.status === 'active' ? '#10B981' : '#EF4444'}; color: white; padding: 4px 8px; border-radius: 12px; font-size: 0.7rem; font-weight: 600;">
                            ${auto.status === 'active' ? 'üü¢ ATIVO' : 'üî¥ INATIVO'}
                        </span>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; font-size: 0.8rem; color: var(--text-muted);">
                        <span>üì° ${auto.endpoint}</span>
                        <span>‚è∞ ${auto.lastRun}</span>
                    </div>
                </div>
            `).join('');
        }

        function generateIntegrationStatus() {
            const integrations = [
                { name: 'Google Calendar', status: 'connected', lastSync: '2 min atr√°s', icon: 'üìÖ' },
                { name: 'ClickUp', status: 'connected', lastSync: '5 min atr√°s', icon: '‚úÖ' },
                { name: 'n8n Workflows', status: 'connected', lastSync: '1 min atr√°s', icon: 'ü§ñ' },
                { name: 'Webhook Endpoints', status: 'connected', lastSync: 'Agora', icon: 'üîó' }
            ];
            
            return integrations.map(int => `
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 16px 0; border-bottom: 1px solid var(--border-light);">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <span style="font-size: 1.5rem;">${int.icon}</span>
                        <div>
                            <div style="font-weight: 600; color: var(--text-primary);">${int.name}</div>
                            <div style="font-size: 0.8rem; color: var(--text-muted);">√öltima sync: ${int.lastSync}</div>
                        </div>
                    </div>
                    <span style="background: ${int.status === 'connected' ? '#10B981' : '#EF4444'}; color: white; padding: 4px 12px; border-radius: 16px; font-size: 0.75rem; font-weight: 600;">
                        ${int.status === 'connected' ? 'üü¢ CONECTADO' : 'üî¥ DESCONECTADO'}
                    </span>
                </div>
            `).join('');
        }

        function generateSyncStats() {
            return `
                <div style="display: grid; gap: 16px;">
                    <div style="text-align: center; padding: 16px; background: var(--bg-secondary); border-radius: 8px;">
                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--success);">98.7%</div>
                        <div style="font-size: 0.8rem; color: var(--text-muted);">Taxa de Sucesso</div>
                    </div>
                    <div style="text-align: center; padding: 16px; background: var(--bg-secondary); border-radius: 8px;">
                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--info);">1.2s</div>
                        <div style="font-size: 0.8rem; color: var(--text-muted);">Tempo M√©dio</div>
                    </div>
                    <div style="text-align: center; padding: 16px; background: var(--bg-secondary); border-radius: 8px;">
                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--primary);">${allTasks.length + allEvents.length}</div>
                        <div style="font-size: 0.8rem; color: var(--text-muted);">Itens Sincronizados</div>
                    </div>
                    <div style="text-align: center; padding: 16px; background: var(--bg-secondary); border-radius: 8px;">
                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--warning);">3</div>
                        <div style="font-size: 0.8rem; color: var(--text-muted);">Falhas (24h)</div>
                    </div>
                </div>
            `;
        }

        function generateTeamStats() {
            // Extrair membros √∫nicos das tarefas
            const members = new Set();
            allTasks.forEach(task => {
                if (task.assignees && task.assignees.length > 0) {
                    task.assignees.forEach(assignee => members.add(assignee));
                }
            });
            
            // Se n√£o houver membros nas tarefas, criar dados mock
            if (members.size === 0) {
                return [
                    {
                        name: 'Jo√£o Silva',
                        sector: 'Design',
                        role: 'Designer S√™nior',
                        activeTasks: 8,
                        completed: 12,
                        inProgress: 3,
                        review: 2,
                        overdue: 1
                    },
                    {
                        name: 'Maria Santos',
                        sector: 'Social Media',
                        role: 'Analista de M√≠dias',
                        activeTasks: 6,
                        completed: 18,
                        inProgress: 4,
                        review: 1,
                        overdue: 0
                    },
                    {
                        name: 'Pedro Costa',
                        sector: 'Audiovisual',
                        role: 'Editor de V√≠deo',
                        activeTasks: 5,
                        completed: 9,
                        inProgress: 2,
                        review: 3,
                        overdue: 0
                    },
                    {
                        name: 'Ana Oliveira',
                        sector: 'Gest√£o',
                        role: 'Gerente de Projetos',
                        activeTasks: 10,
                        completed: 25,
                        inProgress: 5,
                        review: 3,
                        overdue: 2
                    }
                ];
            }
            
            // Processar membros reais
            return Array.from(members).map(memberName => {
                const memberTasks = allTasks.filter(task => 
                    task.assignees && task.assignees.includes(memberName)
                );
                
                const completed = memberTasks.filter(t => t.status === 'complete' || t.status === 'closed').length;
                const inProgress = memberTasks.filter(t => t.status === 'progress' || t.status === 'in progress').length;
                const review = memberTasks.filter(t => t.status === 'review').length;
                const overdue = memberTasks.filter(t => {
                    if (!t.due_date) return false;
                    return new Date(t.due_date) < new Date() && t.status !== 'complete' && t.status !== 'closed';
                }).length;
                
                // Tentar determinar o setor baseado nas tarefas
                const sectors = memberTasks.map(t => t.setor).filter(Boolean);
                const mostCommonSector = sectors.length > 0 ? 
                    sectors.sort((a,b) => sectors.filter(v => v===a).length - sectors.filter(v => v===b).length).pop() :
                    'Geral';
                
                return {
                    name: memberName,
                    sector: mostCommonSector,
                    role: 'Membro da Equipe',
                    activeTasks: memberTasks.filter(t => t.status !== 'complete' && t.status !== 'closed').length,
                    completed,
                    inProgress,
                    review,
                    overdue
                };
            });
        }

        // ===============================
        // üîß FUN√á√ïES DE CONFIGURA√á√ÉO
        // ===============================

        function testAutomations() {
            showLoading(true);
            setTimeout(() => {
                showLoading(false);
                showNotification('üß™ Todas as automa√ß√µes est√£o funcionando corretamente!', 'success');
            }, 2000);
        }

        function openN8nInterface() {
            window.open(CONFIG.N8N_BASE_URL, '_blank');
            showNotification('üîß Abrindo interface do n8n...', 'info');
        }

        function setTheme(theme) {
            if (theme === 'auto') {
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                document.body.setAttribute('data-theme', prefersDark ? 'dark' : 'light');
                showNotification('üîÑ Tema autom√°tico ativado', 'info');
            } else {
                document.body.setAttribute('data-theme', theme);
                document.getElementById('themeToggle').textContent = theme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
                showNotification(`${theme === 'dark' ? 'üåô' : '‚òÄÔ∏è'} Tema ${theme === 'dark' ? 'escuro' : 'claro'} ativado`, 'info');
            }
        }

        function updateSyncInterval(interval) {
            CONFIG.AUTO_SYNC = parseInt(interval);
            showNotification(`üîÑ Intervalo de sincroniza√ß√£o alterado para ${interval/60000} minutos`, 'info');
        }

        function clearCache() {
            allEvents = [];
            allTasks = [];
            updateMetrics();
            renderCurrentView();
            showNotification('üóëÔ∏è Cache limpo com sucesso', 'info');
        }

        function exportSettings() {
            const settings = {
                theme: document.body.getAttribute('data-theme'),
                autoSync: CONFIG.AUTO_SYNC,
                lastExport: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(settings, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'merachi-settings.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification('üì• Configura√ß√µes exportadas!', 'success');
        }

        function resetSettings() {
            if (confirm('üîÑ Tem certeza que deseja restaurar as configura√ß√µes padr√£o?')) {
                setTheme('light');
                CONFIG.AUTO_SYNC = 300000;
                showNotification('üîÑ Configura√ß√µes restauradas para os padr√µes', 'info');
            }
        }

        function exportTeamReport() {
            const teamStats = generateTeamStats();
            const csvContent = 'Nome,Setor,Cargo,Ativas,Completas,Em Progresso,Revis√£o,Atrasadas\n' +
                teamStats.map(member => 
                    `${member.name},${member.sector},${member.role},${member.activeTasks},${member.completed},${member.inProgress},${member.review},${member.overdue}`
                ).join('\n');
            
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'relatorio-equipe-merachi.csv';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification('üìÑ Relat√≥rio da equipe exportado!', 'success');
        }

        function addTeamMember() {
            const name = prompt('üë§ Nome do novo membro:');
            if (name) {
                showNotification(`‚ûï Membro "${name}" ser√° adicionado em breve (funcionalidade em desenvolvimento)`, 'info');
            }
        }

        function addNewEvent() {
            switchTab('event');
            toggleQuickModal();
        }

        function addNewTask() {
            switchTab('task');
            toggleQuickModal();
        }

        function openEvent(eventId) {
            const event = allEvents.find(e => e.id === eventId);
            if (event) {
                showNotification(`Evento: ${event.title}`, 'info');
            }
        }

        function changeEventStatus(event, eventId) {
            event.stopPropagation();
            const currentEvent = allEvents.find(e => e.id === eventId);
            if (!currentEvent) return;

            const statuses = ['confirmed', 'tentative', 'cancelled'];
            const currentIndex = statuses.indexOf(currentEvent.status);
            const nextStatus = statuses[(currentIndex + 1) % statuses.length];
            
            currentEvent.status = nextStatus;
            renderCurrentView();
            showNotification(`Status alterado para ${getStatusLabel(nextStatus)}`, 'info');
        }

        // ===============================
        // üìÖ FUN√á√ïES DO CALEND√ÅRIO
        // ===============================

        let currentCalendarDate = new Date();

        function navigateMonth(direction) {
            currentCalendarDate.setMonth(currentCalendarDate.getMonth() + direction);
            renderCalendar();
        }

        function showDayDetails(dateStr) {
            const selectedDate = new Date(dateStr);
            
            // Determinar quais dados usar baseado no modo
            const eventsToSearch = projectViewMode ? allEvents : getFilteredEvents();
            const tasksToSearch = projectViewMode ? allProjectTasks : getFilteredTasks();
            
            // Buscar eventos e tarefas para este dia
            const dayEvents = eventsToSearch.filter(event => {
                const eventDate = new Date(event.start);
                return eventDate.toDateString() === dateStr;
            });
            
            const dayTasks = tasksToSearch.filter(task => {
                if (projectViewMode) {
                    // No modo projeto, considerar m√∫ltiplas datas
                    const dueDate = task.due_date ? new Date(task.due_date) : null;
                    const startDate = task.start_date ? new Date(task.start_date) : null;
                    const createdDate = task.created_date ? new Date(task.created_date) : null;
                    
                    return (dueDate && dueDate.toDateString() === dateStr) ||
                           (startDate && startDate.toDateString() === dateStr) ||
                           (createdDate && createdDate.toDateString() === dateStr);
                } else {
                    const taskDate = new Date(task.due_date || task.start);
                    return taskDate.toDateString() === dateStr;
                }
            });
            
            const formattedDate = selectedDate.toLocaleDateString('pt-BR', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            const modeIndicator = projectViewMode ? ' üåü (Projeto Completo)' : '';
            
            let modalHTML = `
                <div class="day-details-modal active" id="dayDetailsModal" onclick="closeDayDetails(event)">
                    <div class="day-details-content" onclick="event.stopPropagation()">
                        <div class="day-details-header">
                            <h3 class="day-details-title">${formattedDate}${modeIndicator}</h3>
                            <button class="day-details-close" onclick="closeDayDetails()">‚úï</button>
                        </div>
                        <div class="day-details-body">
            `;
            
            if (dayEvents.length > 0) {
                modalHTML += `
                    <div class="day-section">
                        <div class="day-section-title">üìÖ Eventos (${dayEvents.length})</div>
                        ${dayEvents.map(event => {
                            const eventTime = new Date(event.start).toLocaleTimeString('pt-BR', {
                                hour: '2-digit',
                                minute: '2-digit'
                            });
                            return `
                                <div class="day-item">
                                    <div class="day-item-title">${event.title}</div>
                                    <div class="day-item-meta">
                                        üïê ${eventTime}
                                        ${event.location ? `üìç ${event.location}` : ''}
                                        ${event.description ? `<br>${event.description}` : ''}
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                `;
            }
            
            if (dayTasks.length > 0) {
                modalHTML += `
                    <div class="day-section">
                        <div class="day-section-title">‚úÖ Demandas (${dayTasks.length})</div>
                        ${dayTasks.map(task => {
                            let dateInfo = '';
                            if (projectViewMode) {
                                // Mostrar qual tipo de data est√° sendo exibida
                                const dueDate = task.due_date ? new Date(task.due_date) : null;
                                const startDate = task.start_date ? new Date(task.start_date) : null;
                                const createdDate = task.created_date ? new Date(task.created_date) : null;
                                
                                if (dueDate && dueDate.toDateString() === dateStr) {
                                    dateInfo = 'üìÖ Vencimento';
                                } else if (startDate && startDate.toDateString() === dateStr) {
                                    dateInfo = 'üöÄ In√≠cio';
                                } else if (createdDate && createdDate.toDateString() === dateStr) {
                                    dateInfo = 'üìù Cria√ß√£o';
                                }
                                
                                if (task.project) {
                                    dateInfo += ` | üìÇ ${task.project}`;
                                }
                            }
                            
                            return `
                                <div class="day-item">
                                    <div class="day-item-title">${task.title}</div>
                                    <div class="day-item-meta">
                                        üè¢ ${task.setor || 'Geral'}
                                        <span class="status-badge status-${task.status}">${getTaskStatusLabel(task.status)}</span>
                                        ${task.assignees?.length ? `üë§ ${task.assignees.join(', ')}` : ''}
                                        ${dateInfo ? `<br>${dateInfo}` : ''}
                                        ${task.description ? `<br>${task.description}` : ''}
                                        ${task.url ? `<br>üîó <a href="${task.url}" target="_blank" style="color: var(--primary);">Ver no ClickUp</a>` : ''}
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                `;
            }
            
            if (dayEvents.length === 0 && dayTasks.length === 0) {
                modalHTML += `
                    <div class="empty-state">
                        <h3>Nenhum evento ou demanda</h3>
                        <p>Este dia est√° livre na sua agenda${projectViewMode ? ' (no projeto atual)' : ''}</p>
                    </div>
                `;
            }
            
            modalHTML += `
                        </div>
                    </div>
                </div>
            `;
            
            // Remover modal existente se houver
            const existingModal = document.getElementById('dayDetailsModal');
            if (existingModal) {
                existingModal.remove();
            }
            
            // Adicionar novo modal
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        }

        function closeDayDetails(event) {
            if (event && event.target !== event.currentTarget) return;
            
            const modal = document.getElementById('dayDetailsModal');
            if (modal) {
                modal.remove();
            }
        }

        // Atualizar a fun√ß√£o renderCalendar para usar a data atual do calend√°rio
        function renderCalendar() {
            // Determinar o container correto baseado na visualiza√ß√£o atual
            let container;
            if (currentView === 'calendario') {
                container = document.getElementById('calendarioFullView');
            } else {
                // Fallback para o container original
                const originalContainer = document.getElementById('calendarEvents');
                if (originalContainer) {
                    container = originalContainer.parentElement.parentElement;
                }
            }
            
            if (!container) {
                console.error('Container do calend√°rio n√£o encontrado');
                return;
            }
            
            const year = currentCalendarDate.getFullYear();
            const month = currentCalendarDate.getMonth();
            const today = new Date();
            
            // Primeira e √∫ltima data do m√™s
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            
            // Primeira data da grade (pode ser do m√™s anterior)
            const startDate = new Date(firstDay);
            startDate.setDate(startDate.getDate() - firstDay.getDay());
            
            const monthNames = [
                'Janeiro', 'Fevereiro', 'Mar√ßo', 'Abril', 'Maio', 'Junho',
                'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'
            ];
            
            const daysOfWeek = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'S√°b'];
            
            // Determinar quais tarefas usar baseado no modo
            const tasksToUse = projectViewMode ? allProjectTasks : allTasks;
            const eventsToUse = projectViewMode ? allEvents : getFilteredEvents();
            
            let calendarHTML = `
                <div class="calendar-container">
                    <div class="calendar-header">
                        <button class="calendar-nav-btn" onclick="navigateMonth(-1)">‚Äπ</button>
                        <h2 class="calendar-month-title">
                            ${monthNames[month]} ${year}
                            ${projectViewMode ? '<span style="font-size: 0.8rem; color: #FF6B6B; margin-left: 8px;">üåü PROJETO COMPLETO</span>' : ''}
                        </h2>
                        <button class="calendar-nav-btn" onclick="navigateMonth(1)">‚Ä∫</button>
                    </div>
                    
                    <div class="calendar-grid">
                        ${daysOfWeek.map(day => `<div class="calendar-day-header">${day}</div>`).join('')}
            `;
            
            // Gerar 42 dias (6 semanas)
            const currentDate = new Date(startDate);
            for (let i = 0; i < 42; i++) {
                const isCurrentMonth = currentDate.getMonth() === month;
                const isToday = currentDate.toDateString() === today.toDateString();
                const dateStr = currentDate.toDateString();
                
                // Buscar eventos e tarefas para este dia
                const dayEvents = eventsToUse.filter(event => {
                    const eventDate = new Date(event.start);
                    return eventDate.toDateString() === dateStr;
                });
                
                const dayTasks = tasksToUse.filter(task => {
                    // No modo projeto, considerar tanto due_date quanto start_date
                    if (projectViewMode) {
                        const dueDate = task.due_date ? new Date(task.due_date) : null;
                        const startDate = task.start_date ? new Date(task.start_date) : null;
                        const createdDate = task.created_date ? new Date(task.created_date) : null;
                        
                        return (dueDate && dueDate.toDateString() === dateStr) ||
                               (startDate && startDate.toDateString() === dateStr) ||
                               (createdDate && createdDate.toDateString() === dateStr);
                    } else {
                        const taskDate = new Date(task.due_date || task.start);
                        return taskDate.toDateString() === dateStr;
                    }
                });
                
                const dayClass = `calendar-day-cell ${isToday ? 'today' : ''} ${!isCurrentMonth ? 'other-month' : ''}`;
                
                // Adicionar indicador visual para modo projeto
                const projectModeStyle = projectViewMode ? 'border: 2px solid #FF6B6B; box-shadow: inset 0 0 10px rgba(255, 107, 107, 0.1);' : '';
                
                calendarHTML += `
                    <div class="${dayClass}" onclick="showDayDetails('${dateStr}')" style="${projectModeStyle}">
                        <div class="calendar-day-number">${currentDate.getDate()}</div>
                        <div class="calendar-day-content">
                            ${dayEvents.map(event => 
                                `<div class="calendar-event-item" title="${event.title}">
                                    üìÖ ${event.title.substring(0, 15)}${event.title.length > 15 ? '...' : ''}
                                </div>`
                            ).join('')}
                            ${dayTasks.map(task => {
                                // No modo projeto, adicionar informa√ß√£o de status e setor
                                const taskPrefix = projectViewMode ? `${getSectorIcon(task.setor)} ${getTaskStatusIcon(task.status)}` : '‚úÖ';
                                const taskClass = projectViewMode ? 'calendar-project-task-item' : 'calendar-task-item';
                                return `<div class="${taskClass}" title="${task.title} - ${task.setor} - ${getTaskStatusLabel(task.status)}">
                                    ${taskPrefix} ${task.title.substring(0, 12)}${task.title.length > 12 ? '...' : ''}
                                </div>`;
                            }).join('')}
                        </div>
                    </div>
                `;
                
                currentDate.setDate(currentDate.getDate() + 1);
            }
            
            calendarHTML += `
                    </div>
                </div>
            `;
            
            // Adicionar informa√ß√µes do projeto se estiver no modo projeto
            if (projectViewMode && tasksToUse.length > 0) {
                const statusCount = {};
                const sectorCount = {};
                
                tasksToUse.forEach(task => {
                    statusCount[task.status] = (statusCount[task.status] || 0) + 1;
                    sectorCount[task.setor] = (sectorCount[task.setor] || 0) + 1;
                });
                
                calendarHTML += `
                    <div style="margin-top: 20px; padding: 16px; background: linear-gradient(135deg, #FF6B6B, #4ECDC4); border-radius: 12px; color: white;">
                        <h4 style="margin: 0 0 12px 0;">üìä Resumo do Projeto</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; font-size: 0.85rem;">
                            <div>
                                <strong>Status:</strong><br>
                                ${Object.entries(statusCount).map(([status, count]) => 
                                    `${getTaskStatusIcon(status)} ${getTaskStatusLabel(status)}: ${count}`
                                ).join('<br>')}
                            </div>
                            <div>
                                <strong>Setores:</strong><br>
                                ${Object.entries(sectorCount).map(([setor, count]) => 
                                    `${getSectorIcon(setor)} ${setor}: ${count}`
                                ).join('<br>')}
                            </div>
                        </div>
                    </div>
                `;
            }
            
            container.innerHTML = calendarHTML;
        }

        // NOVA FUN√á√ÉO: Obter √≠cone do status da tarefa
        function getTaskStatusIcon(status) {
            const icons = {
                'open': 'üìã',
                'Open': 'üìã',
                'progress': '‚ö°',
                'in progress': '‚ö°',
                'review': 'üëÄ',
                'complete': '‚úÖ',
                'closed': '‚úÖ'
            };
            return icons[status] || 'üìù';
        }

        console.log('ü¶ã MERACHI Dashboard carregado com endpoints do index 3');

        /*
        ===============================
        üì° NOVO ENDPOINT NECESS√ÅRIO
        ===============================
        
        Para ativar a funcionalidade de "Visualiza√ß√£o Completa de Projeto", 
        voc√™ precisar√° criar este endpoint no n8n:
        
        ENDPOINT: /webhook/dashboard-project-view
        M√âTODO: GET
        
        RESPOSTA ESPERADA:
        {
            "success": true,
            "projectTasks": [
                {
                    "id": "task_id",
                    "title": "Nome da tarefa",
                    "description": "Descri√ß√£o detalhada",
                    "setor": "Design",
                    "status": "open",
                    "assignees": ["Jo√£o", "Maria"],
                    "due_date": "2025-08-25T00:00:00Z",
                    "start_date": "2025-08-20T00:00:00Z",
                    "created_date": "2025-08-15T00:00:00Z",
                    "priority": "high",
                    "url": "https://clickup.com/task/...",
                    "project": "Nome do Projeto",
                    "dependencies": ["task_id_1", "task_id_2"],
                    "tags": ["frontend", "urgente"]
                }
            ]
        }
        
        DIFEREN√áAS DO ENDPOINT NORMAL:
        1. Retorna TODAS as tarefas do projeto, sem filtro de data
        2. Inclui campos adicionais: start_date, created_date, project, dependencies, tags
        3. Permite visualiza√ß√£o completa do cronograma do projeto
        4. Ideal para visualiza√ß√£o no calend√°rio distribu√≠da ao longo do tempo
        
        CONFIGURA√á√ÉO SUGERIDA NO N8N:
        1. Webhook Node configurado para GET
        2. ClickUp Node com filtros amplos (ex: todos os status, todas as datas)
        3. Fun√ß√£o para enriquecer dados com start_date, project, dependencies
        4. Response Node com a estrutura acima
        
        Com este endpoint, o usu√°rio poder√°:
        ‚úÖ Ver todas as tarefas no calend√°rio independente da data
        ‚úÖ Visualizar cronograma completo do projeto
        ‚úÖ Acompanhar depend√™ncias e marcos importantes
        ‚úÖ Ter uma vis√£o estrat√©gica do projeto inteiro
        */
    </script>
</body>
</html>